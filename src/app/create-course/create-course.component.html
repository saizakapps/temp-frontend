<section class=" w-100  portalDetails">
  <!-- <mat-checkbox disabled [checked]="view">View</mat-checkbox>
  <mat-checkbox (change)="create = !create">Create</mat-checkbox>
  <mat-checkbox (change)="update = !update">Update</mat-checkbox> -->
  <!-- GhostLoader -->
  <div class="showShimmer" *ngIf="showShimmer">
    <div class="d-flex justify-content-between">
    <shimmer [width]="'30%'" height="10px" borderRadius="25px"></shimmer>
    <shimmer [width]="'15%'" height="10px" borderRadius="25px"></shimmer>
    </div>
    <div class="shimmerBox shimmerBox1 mt-1">
      <shimmer [width]="'65%'" height="10px" borderRadius="25px"></shimmer>
    </div>
    <div class="shimmerBox shimmerBox2 mb-3">

    </div>

    <shimmer [width]="'20%'" height="10px" borderRadius="25px"></shimmer>
    <div class="shimmerBox shimmerBox-50 mt-1">
    </div>

    <div class="shimmerBox shimmerBoxHeight mt-4">
      <div class="px-2 pt-2 pb-2">
      <shimmer [width]="'92%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'85%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'88%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'93%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'87%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'92%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'93%'" height="10px" borderRadius="25px"></shimmer>
      <shimmer [width]="'55%'" height="10px" borderRadius="25px"></shimmer>
    </div>
    </div>
  </div>
  <!-- GhostLoader -->

  <!-- Content Area -->
  <div *ngIf="!showShimmer" class="row h-100 flex-column courseCretionDiv ">

    <div class=" pr-0 courseSectionContent courseParentDiv">
      <div class="courseScrollContent">
        <div>
          <div class="courseCls ">
            <div class="d-flex align-items-center courseTypeCls">
              <div class="d-flex align-items-center w-100 float-left mt-2">
                <div class="courseTypeName mr-2"> Course type: </div>
                <!-- <ng-select *ngIf="[courseCode.Regular, courseCode.Recurring].includes(courseConfig.code)" class="mt-3"
                (change)="changeCourseType($event)" [items]="courseTypes" name="code"
                bindValue="code" bindLabel="code" [clearable]=false [searchable]=false
                [(ngModel)]="courseConfig.code">
              </ng-select> -->
                <div class="courseTypeName">
                  <!-- *ngIf="![courseCode.Regular, courseCode.Recurring].includes(courseConfig.code)" -->
                  {{courseConfig.courseTypeDesc}}
                </div>
              </div>

              <!-- F2F course category (Available only for F2F) -->
              <!-- <ng-select (click)="policyGroupOnClick()" [items]="periodItems" name="period" bindValue="key" bindLabel="name"
                [clearable]=true [searchable]=false [(ngModel)]="course.category" placeholder="Category" class="periodSelectCls">
              </ng-select> -->

              <div class="float-right  d-flex align-items-center w-100 mt-2 justify-content-end">
                <!-- <div class="btn-group mr-2 publishDraftCls" role="group" aria-label="First group">
                  <div *ngIf="publishDraft.publish || publishDraft.draft">
                    <button class="courseCopyBtn">
                      <img (click)="copyCourse()" alt="copy" title="copy" src="/assets/images/copyIcon.png" width="13px"
                        height="13px">
                    </button>
                  </div>
                </div> -->
                <div [ngClass]="{'viewOnly': (view && !create && !update)}" *ngIf="courseTypeDetail.type === 'edit'">
                  <span [matMenuTriggerFor]="manageMenu" type="text" class="d-flex align-items-center manageCls">
                    <span class="manageText"> Manage </span>
                    <img src="/assets/images/settings.png" width="13px" height="13px"> </span>
                </div>
              </div>
            </div>
            <div class="manageChangeCls">
              <mat-menu #manageMenu="matMenu" class="manageCourse">
                <div class="d-flex">
                  <div>
                    <div *ngIf="publishDraft.publish || publishDraft.draft" (click)="copyCourse()"
                      class="d-flex justify-content-between" mat-menu-item>
                      <span class="smallMenuText"> Make a copy </span>
                    </div>
                    <div *ngIf="courseTypeDetail.view === 'publish'" (click)="changePublishedStatus()"
                      class="d-flex justify-content-between" mat-menu-item>
                      <span class="smallMenuText">
                        {{ course.active ? 'Disable' : 'Enable' }} </span>
                    </div>
                    <div *ngIf="courseTypeDetail.view === 'draft'" (click)="openAlert('deleteCourse')"
                      class="d-flex justify-content-between" mat-menu-item>
                      <span class="smallMenuText manageDeleteCourse"> Delete </span>
                    </div>
                  </div>
                </div>
              </mat-menu>

            </div>
            <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="d-flex align-items=-center mt-2 courseIntExt">
              <div class="w-100">

                <input name="externalCourseName" [(ngModel)]="course.externalCourseName" type="text"
                  class="courseCreateText w-100 mr-2 interName" (input)="updateInternalName()"
                  (change)="copiedCourseName = false">
                <span class="presentName">Presented name</span>



                <input name="internalCourseName" (change)="copiedCourseName = false"
                  [(ngModel)]="course.internalCourseName" type="text"
                  [ngClass]="{grayText: course.externalCourseName === course.internalCourseName}"
                  class="courseCreateText w-100 internalNameTxt pr-3 interName">
                <span class="internalName">
                  <span class="mr-1">Internal name</span>
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg"
                    (click)="course.internalCourseName = course.externalCourseName"
                    [attr.stroke]="course.externalCourseName === course.internalCourseName ? '#818181' : '#1f96f4'"
                    class="internalImg">
                    <path
                      d="M2 9.5H6.5C8.15685 9.5 9.5 8.15685 9.5 6.5V6.5C9.5 4.84315 8.15685 3.5 6.5 3.5H1.5M1.5 3.5L4 6M1.5 3.5L4 1" />
                  </svg>
                </span>



              </div>
              <!-- <div class=" d-flex justify-content-center align-items-center toggleCls">
                <button class="btn deleteBtn" (click)="openAlert('deleteCourse')"
                  *ngIf="courseTypeDetail.type === 'create' || courseTypeDetail.view === 'draft'">
                  <i class="fa fa-trash" aria-hidden="true"></i>
                </button>
                <mat-slide-toggle *ngIf="courseTypeDetail.type === 'edit' && courseTypeDetail.view === 'publish'"
                  [checked]="course.active" (change)="changePublishedStatus()">
                  {{ course.active ? 'Active' : 'Inactive'}} </mat-slide-toggle>

              </div> -->
            </div>

          </div>
          <div class="courseRegionContent">
            <form class="form-inline">


              <div>
                <div class="form-group d-flex align-items-center mb-0">
                  <div>
                    <label>Roles & Levels</label>
                    <mat-form-field *ngIf="nonlevelCourses.includes(courseConfig.code)" appearance="fill" class="mr-2"
                      [ngClass]="{appliedFilter: !roleNotSelected()}">
                      <mat-label *ngIf="selectedLevelCount < 1"> Select Role group / Roles </mat-label>
                      <mat-label *ngIf="selectedLevelCount > 0" class="levelSelected">
                        {{selectedLevelCount + ' role selected'}}
                      </mat-label>
                      <mat-select #selector1 (openedChange)="checkCountryAndRoleSelected($event, 'role1')">
                        <mat-option (click)="selector1.open()" class="createRoleCls">
                          <!-- <input mat-tree (keyup)="hierarchySearch($event, countryList)"> -->
                          <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="node1 tree">
                            <mat-icon class="invisible"></mat-icon>
                            <mat-checkbox name="allRole" (change)="allRoleSelect($event)"> All </mat-checkbox>
                          </div>
                          <div class="node1 tree " *ngFor="let node1 of roleGroupList; let node1Index = index">
                            <mat-icon *ngIf="node1.child?.length > 1" class="mat-icon-rtl-mirror mt-1 matIconCls"
                              (click)="toggleRole($event, node1);$event.stopPropagation();">
                              {{node1.isCollapsed ? 'chevron_right' : 'expand_more'}}
                            </mat-icon>
                            {{node1.desc}}
                            <ng-container *ngIf="!node1.isCollapsed">
                              <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="node2 policiesSelect"
                                *ngFor="let node2 of node1.child; let node2Index = index">
                                <mat-checkbox [name]="node1Index + '-' + node2Index" [(ngModel)]="node2.checked">
                                  {{node2.desc}}</mat-checkbox>
                              </div>
                            </ng-container>
                          </div>
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                    <mat-form-field *ngIf="!nonlevelCourses.includes(courseConfig.code)" appearance="fill" class="mr-2"
                      [ngClass]="{appliedFilter: !levelNotSelected()}">
                      <mat-label *ngIf="selectedLevelCount < 1 && !isSuggestedCourse"> Select Role group / Roles / Level
                      </mat-label>
                      <mat-label *ngIf="isSuggestedCourse"> Suggested course </mat-label>
                      <mat-label *ngIf="selectedLevelCount > 0 && !isSuggestedCourse" class="levelSelected">
                        {{selectedLevelCount + ' level selected'}}
                      </mat-label>
                      <mat-select #selector2 (openedChange)="checkCountryAndRoleSelected($event, 'role2')">
                        <mat-option (click)="selector2.open()" class="createRoleCls">
                          <!-- <input mat-tree (keyup)="hierarchySearch($event, countryList)"> -->
                          <div [ngClass]="{opacityCheck: isSuggestedCourse && node1.desc !== 'Suggested'}"
                            class="node1 tree" *ngFor="let node1 of roleGroupList; let node1Index = index">
                            <mat-icon *ngIf="node1.child?.length > 1 && node1.code !== 'LAS'"
                              class="mat-icon-rtl-mirror mt-1 matIconCls"
                              (click)="toggleRole($event, node1);$event.stopPropagation();">
                              {{node1.isCollapsed ? 'chevron_right' : 'expand_more'}}
                            </mat-icon>
                            <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update)}" class="suggestedCls" [(ngModel)]="isSuggestedCourse" name="suggested"
                              *ngIf="node1.code === 'LAS'" (change)="clickSuggestedCourse($event)"></mat-checkbox>
                            {{node1.desc}}
                            <ng-container *ngIf="!node1.isCollapsed && node1.code !== 'LAS'">
                              <div class="node2" *ngFor="let node2 of node1.child; let node2Index = index">
                                <mat-icon [ngClass]="{invisible: !node2.child || node2.child?.length < 1}"
                                  class="mat-icon-rtl-mirror mt-2 ml-4 matIconCls"
                                  (click)="toggleRole($event, node2);$event.stopPropagation();">
                                  {{node2.isCollapsed ? 'chevron_right' : 'expand_more'}}
                                </mat-icon>
                                {{node2.desc}}
                                <ng-container *ngIf="!node2.isCollapsed">
                                  <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="roleRadioBtn">
                                    <mat-radio-group [name]="node1.id + node2.id"
                                      aria-labelledby="example-radio-group-label" class="example-radio-group"
                                      [(ngModel)]="node2.selectedLevel">
                                      <div class="roleRadioGroup">
                                        <mat-icon class="invisible mat-icon-rtl-mirror mt-2 d-none">
                                          expand_more
                                        </mat-icon>
                                        <ng-container *ngFor="let node3 of node2.child">
                                          <div *ngIf="node3.desc !== 'Suggested'" class="treeCloseIcon d-flex">
                                            <mat-radio-button class="node3" [value]="node3.id"
                                              [disabled]="isSuggestedCourse">
                                              {{node3.desc}}
                                            </mat-radio-button>
                                            <a *ngIf="node2.selectedLevel && node2.selectedLevel === node3.id" (click)="node2.selectedLevel = undefined;">X</a>
                                          </div>
                                        </ng-container>
                                      </div>
                                    </mat-radio-group>
                                  </div>
                                </ng-container>
                              </div>
                            </ng-container>
                          </div>
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>


                  <div class="">
                    <label>Locations</label>
                    <mat-form-field appearance="fill" 
                      [ngClass]="{appliedFilter: selectedStoreCount > 0}">
                      <mat-label *ngIf="selectedStoreCount < 1"> Select Countries / Regions / Stores </mat-label>
                      <mat-label *ngIf="selectedStoreCount > 0" class="levelSelected">
                        {{selectedStoreCount + ' stores selected'}} </mat-label>
                      <mat-select #locationSelect class="roleSelectionCls" (openedChange)="checkCountryAndRoleSelected($event, 'location')">
                        <!-- [disabled]="courseConfig.code === courseCode.Policies ? roleNotSelected() : levelNotSelected()" -->
                        <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update)}" id="all" class="w-100 allCheckbox countryCheckbox" name="allCountries"
                          (change)="selectAll($event, countryList, 'country'); calcSelectedStore();">
                          All</mat-checkbox>
                        <mat-tree [dataSource]="countryList" [treeControl]="roleTreeControl" class="example-tree">
                          <mat-option class="disableRipple">
                            <!-- This is the tree node template for leaf nodes -->
                            <mat-nested-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
                              <li class="mat-tree-node">
                                <!-- use a disabled button to provide padding for tree leaf -->
                                <button mat-icon-button disabled></button>
                                <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update)}" class="ml-3"
                                  (change)="selectionToggleLeaf($event.checked, node, 'country'); calcSelectedStore();"
                                  [checked]="node.selectStatus === 'checked'">{{node.desc}}</mat-checkbox>
                              </li>
                            </mat-nested-tree-node>
                            <!-- This is the tree node template for expandable nodes -->
                            <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                              <ul>
                                <li>
                                  <div class="mat-tree-node">
                                    <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.desc">
                                      <mat-icon class="mat-icon-rtl-mirror m-0 roleIcon">
                                        {{roleTreeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                                      </mat-icon>
                                    </button>
                                    <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update)}"
                                      (change)="selectionToggle($event.checked, node, 'country'); calcSelectedStore();"
                                      [indeterminate]="node.selectStatus === 'mixed'"
                                      [checked]="node.selectStatus === 'checked'">
                                      {{node.desc}}</mat-checkbox>
                                  </div>
                                  <ul [class.example-tree-invisible]="!roleTreeControl.isExpanded(node)">
                                    <ng-container matTreeNodeOutlet></ng-container>
                                  </ul>
                                </li>
                              </ul>
                            </mat-nested-tree-node>
                          </mat-option>
                        </mat-tree>
                      </mat-select>
                    </mat-form-field>
                  </div>

                  <div *ngIf="courseConfig.code === this.courseCode.Policies">
                    <label class="pl-2">Policy group</label>
                    <ng-select (click)="policyGroupOnClick()" [ngClass]="{appliedFilter: course.categoryId}" [(ngModel)]="course.categoryId" [items]="policyCategory" name="period" bindValue="id" bindLabel="name" [clearable]=true
                    [searchable]=false placeholder="Select group" class="periodSelectCls" (change)="setPolicyCategory($event)"></ng-select>
                  </div>

                  <div *ngIf="courseConfig.expiryDate">
                    <label class="pl-2">Recurring</label>
                    <ng-select (click)="policyGroupOnClick()" [items]="periodItems" name="period" bindValue="key" bindLabel="name" [clearable]=true
                      [searchable]=false [(ngModel)]="course.period" placeholder="period" class="periodSelectCls">
                      <!-- [disabled]="selectedLevelCount < 1"  -->
                    </ng-select>
                  </div>

                  <!-- <mat-form-field class="datePickercls ml-2 ">
                    <input matInput [(ngModel)]="course.period" [matDatepicker]="picker" placeholder="Period"
                      name="dateOfJoining" [disabled]="selectedLevelCount < 1">
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-datepicker #picker></mat-datepicker>
                  </mat-form-field> -->
                  <!-- Temp fix -->
                  <div class="d-flex align-items-center ml-3 confirmContent" *ngIf="courseConfig.managerConfirmation">
                    <mat-checkbox [(ngModel)]="course.managerConfirmation" name="managerConfirm"
                      [disabled]="[courseCode.Checklist].includes(courseConfig.code) || (view && !create && !update)">
                      <!-- courseCode.F2F,  -->
                      <!--  || selectedLevelCount < 1 -->
                      Confirm.req.
                    </mat-checkbox>
                    <!-- <label for="store" class="confirmationBox">Confirm.req.</label> -->
                  </div>
                </div>
              </div>

            </form>
          </div>


        </div>

        <div>
          <div class="courseContentSection">
            <!--  [ngClass]="{overlay: selectedLevelCount < 1}" -->
            <div class="mb-0 courseQuestions">
              <div class="d-flex courseQuesDiv">
                <div class="btn-group mr-2 float-left courseGroupCls" role="group" aria-label="First group">
                  <button type="button" [ngClass]="{active: selectedForm === 'courseContent'}"
                    class="btn courseContentDetails" (click)="changeForm('courseContent')"
                    *ngIf="courseConfig.courseContent"> Course Content </button>
                  <button type="button" [ngClass]="{active: selectedForm === 'questionaire'}"
                    class="btn courseContentDetails" (click)="changeForm('questionaire')" *ngIf="courseConfig.quiz"
                    [disabled]="courseConfig.courseContent && (course.chapters[0]?.activities[0].activityType === 'quiz' ? course.chapters[0]?.activities[0]?.questions[0]?.content?.length < 1 : course.chapters[0]?.activities[0]?.content?.length < 1) && courseConfig.code !== courseCode.F2F">
                    Questionnaire </button>
                  <button type="button" [ngClass]="{active: selectedForm === 'completionMessage'}" class="btn courseContentDetails"
                    (click)="changeForm('completionMessage')" *ngIf="courseConfig.completionMessage"
                    [disabled]="((course.chapters[0]?.activities[0].activityType === 'quiz' ? course.chapters[0]?.activities[0]?.questions[0]?.content?.length < 1 : course.chapters[0]?.activities[0]?.content?.length < 1) || (courseConfig.quizOptional !== true && courseConfig.quiz === true && atleastSingleQuestion()))  && courseConfig.code !== courseCode.F2F">
                    Completion Message</button>
                  <ng-container *ngIf="courseConfig.code === courseCode.F2F">
                    <button type="button" [ngClass]="{active: selectedForm === 'pdfCertification'}" class="btn courseContentDetails"
                    (click)="changeForm('pdfCertification')" *ngIf="courseConfig.pdfCertification">
                    Certification</button>
                  </ng-container>
                </div>

                <div class="float-right w-100 d-flex align-items-center justify-content-end">
                  <div class="btn-group float-left courseGroupCls" role="group" aria-label="First group">
                    <button type="button" class="btn courseContentDetails publishDraftContent active mr-0"
                      *ngIf="publishDraft.publish"
                      (click)="courseTypeDetail.view !== 'publish' && openAlert('switchPulishDraft', 'publish')"
                      [ngClass]="{active: courseTypeDetail.view === 'publish'}">
                      <svg width="12" height="14" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg"
                        class="publishImg">
                        <path
                          d="M12 0.333252C2 0.333252 0.666667 9.66659 0 13.6666H1.332C1.776 11.4446 2.88733 10.2226 4.66667 9.99992C7.33333 9.66659 9.33333 7.33325 10 5.33325L9 4.66659L9.66667 3.99992C10.3333 3.33325 11.0027 2.33325 12 0.333252Z"
                          fill="black" />
                      </svg>
                      <span class="ml-2"> View published </span>

                    </button>
                    <button type="button" class="btn courseContentDetails publishDraftContent saveDraft mr-0 vDraftbtn"
                      *ngIf="publishDraft.draft"
                      (click)="courseTypeDetail.view !== 'draft' && openAlert('switchPulishDraft', 'draft')"
                      [ngClass]="{active: courseTypeDetail.view === 'draft'}"> View draft
                    </button>
                  </div>







                  <button class="versionHistory" [disabled]="courseHistory?.length < 1" data-toggle="modal"
                    data-target="#historyModal">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M8 5.33325V8.66659H11.3333V7.33325H9.33333V5.33325H8Z" fill="black" />
                      <path
                        d="M14.1943 5.66467C13.8936 4.95137 13.4571 4.30334 12.909 3.75667C12.0794 2.92704 11.0248 2.35874 9.87568 2.122C9.07807 1.95966 8.25594 1.95966 7.45834 2.122C6.30812 2.35722 5.25266 2.926 4.42367 3.75733C3.87693 4.30459 3.44056 4.95191 3.13834 5.664C2.82575 6.40308 2.66522 7.19754 2.66634 8L2.66701 8.01667H1.33301L3.33301 10.6667L5.33301 8.01667H4.00034L3.99967 8C3.99776 7.07025 4.27532 6.16138 4.79634 5.39134C5.13242 4.89446 5.56031 4.46634 6.05701 4.13C6.5623 3.7896 7.12909 3.55093 7.72567 3.42733C8.93803 3.17807 10.1998 3.42042 11.2335 4.10111C12.2672 4.78181 12.9883 5.84513 13.2383 7.05734C13.3641 7.67859 13.3641 8.31875 13.2383 8.94C13.1164 9.53709 12.8776 10.1042 12.5357 10.6087C12.369 10.856 12.1777 11.0887 11.9663 11.2993C11.5405 11.7247 11.0369 12.0644 10.483 12.3C10.2009 12.4193 9.90769 12.5104 9.60767 12.572C8.98663 12.6977 8.34671 12.6977 7.72567 12.572C7.12921 12.4497 6.56265 12.2112 6.05834 11.87C5.81031 11.7024 5.57882 11.5115 5.36701 11.3L4.42434 12.2427C4.98109 12.8002 5.64236 13.2424 6.37027 13.5439C7.09819 13.8455 7.87844 14.0005 8.66634 14C9.46838 13.9997 10.2623 13.8394 11.0017 13.5287C12.0734 13.0752 12.9904 12.3202 13.641 11.3553C14.3107 10.3646 14.6678 9.19582 14.6663 8C14.668 7.1977 14.5075 6.40334 14.1943 5.66467Z"
                        fill="black" />
                    </svg>

                    <span class="ml-1">History</span>
                  </button>
                  <button
                  (click)="courseConfig.code === courseCode.SlideShow || getMediaUrlList().length > 0 ? mediaDownload() : print()"
                  [disabled]="!enablePdfButton() || (view && !create && !update)"
                  *ngIf="((courseConfig.code === courseCode.SlideShow && getMediaUrlList().length > 0 && (selectedForm === 'courseContent' || selectedForm === 'questionaire')) ||
                    (courseConfig.code === courseCode.Checklist && (selectedForm === 'courseContent' || selectedForm === 'checklist' || selectedForm === 'questionaire'))) ||
                    !enableDownloadDropDown()" class="pdfDownload">
                    <img alt="pdf-download" height="25px" src="assets/images/download-course.png">
                  </button>
                  <button [matMenuTriggerFor]="downloadMenu" data-toggle="tooltip" title="download" [disabled]="!enablePdfButton() || (view && !create && !update)" *ngIf="(courseConfig.code !== courseCode.SlideShow && (selectedForm === 'courseContent' || selectedForm === 'questionaire')) && (enableDownloadDropDown())" class="pdfDownload">
                    <img alt="pdf-download" height="25px" src="assets/images/download-course.png">
                  </button>
                  <div class="manageChangeCls">
                    <mat-menu #downloadMenu="matMenu" class="manageCourse">
                      <div class="d-flex">
                        <div>
                          <div *ngIf="!isAllFileContent() && courseConfig.code !== courseCode.SlideShow" (click)="print()"
                            class="d-flex justify-content-between" mat-menu-item>
                            <span class="smallMenuText"> Content download </span>
                          </div>
                          <div *ngIf="getMediaUrlList().length > 0" (click)="mediaDownload()"
                            class="d-flex justify-content-between" mat-menu-item>
                            <span class="smallMenuText"> Media download </span>
                          </div>
                        </div>
                      </div>
                    </mat-menu>
                  </div>
                </div>
              </div>
            </div>

            <ng-container *ngIf="selectedForm === 'courseContent' && courseConfig.courseContent">
              <div *ngIf="courseConfig.code !== courseCode.SlideShow" class="row pr-0 flex-nowrap textEditorArea"
                cdkDropListGroup>

                <div class=" p-0 leftSideContent border-end-0">
                  <span class="chaptersContents d-block ml-3 text-center">Chapters</span>
                  <div id="targetscroll" class="chapterScrollcontent" cdkDropList [cdkDropListData]="course.chapters"
                    (cdkDropListDropped)="drop($event)">
                    <div cdkDrag *ngFor="let chapter of course.chapters; let chapterIndex = index;"
                      [ngClass]="{activeChapter: chapter.chapterId === selectedChapter.chapterId}"
                      class="d-flex  flex-column chapterBlock textDropFields">
                      <span class=" mt-0" (click)="clickChapter(chapter, chapterIndex)">
                        <div class="chaptersList d-flex m-0"
                          [ngClass]="{active: chapter.chapterId === selectedChapter.chapterId}">
                          <mat-icon [ngClass]="{'invisible': !(chapter.activities?.length > 1 && chapter.chapterType)}"
                            class="mat-icon-rtl-mirror mt-1 chapterIconExpand"
                            (click)="toggleAccordian($event, chapter, chapterIndex)">
                            {{chapter.isExpanded ? 'expand_more' : 'chevron_right'}}
                          </mat-icon>
                          <span [ngClass]="{'viewOnly': (view && !create && !update)}" *ngIf="chapter.chapterType" class="d-flex align-items-center mt-0">
                            <span class="pb-0 chapterNumbers ml-2"> {{chapter.chapterId}} </span>


                            <ng-select (click)="policyGroupOnClick()" class=" activityTextView" (change)="changeChapterType($event, chapter)"
                              [appendTo]="'body'" [items]="chapterTypes" [name]="'chapter' + chapter.chapterId"
                              bindValue="key" [clearable]=false [searchable]="false" bindLabel="name"
                              [(ngModel)]="chapter.chapterType">
                            </ng-select>
                            <img src="assets/images/delete-user.svg" height="13px" width="13px"
                              (click)="openAlert('deleteChapter', chapterIndex, chapter)"
                              class="ml-2 mb-0 closeActivity" [ngClass]="{invisible : course.chapters.length < 3}"
                              title="Delete Chapter">
                          </span>
                          <button *ngIf="!chapter.chapterType" (click)="addChapter();$event.stopPropagation();handleScroll()"
                            type="button" class="btn courseContentDetails addChapterCls mt-3 addActivity"
                            [disabled]="!areChaptersValid() || (view && !create && !update)">
                            <!-- [disabled]="chapters[chapters?.length - 2]?.activities[0]?.content?.length < 1"> -->
                            + Add chapter
                          </button>
                        </div>
                      </span>
                      <div *ngIf="!chapter.isExpanded || (chapter.chapterType && chapter.activities?.length > 1)"
                        [ngClass]="{mh: !chapter.isExpanded}" class="panel p-0 panelDivCls" style="max-height:200px"
                        cdkDropList [cdkDropListData]="chapter.activities" (cdkDropListDropped)="drop($event)">
                        <!-- childPanelCls -->
                        <div cdkDrag (click)="clickActivity(chapter, activity, chapterIndex)"
                          *ngFor="let activity of chapter.activities; let activityIndex = index;"
                          class="d-flex  childElements  chapterElements pt-1"
                          [ngClass]=" {activeList: chapter.chapterId===selectedChapter.chapterId && activity.activityId===selectedActivity.activityId}">


                          <span *ngIf="activity.activityType" class="textDropdown d-flex align-items-center mb-3">
                            <!-- <div [matMenuTriggerFor]="activityText" class="activityTextCls">
                              <svg width="7" height="5" viewBox="0 0 7 5" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.5 4.5L0 0H7L3.5 4.5Z" fill="black" />
                              </svg>
                            </div> -->
                            <ng-select [disabled]="(view && !create && !update)" (click)="policyGroupOnClick()" class="activitySelectCls activityTextView d-flex" [items]="activityTypes"
                              [appendTo]="'body'" [name]="'activityType' + activity.activityId"
                              (change)="activityChange($event, activity)" bindValue="key" [clearable]=false
                              [searchable]="false" bindLabel="name" [(ngModel)]="activity.activityType">
                            </ng-select>

                            <img src="assets/images/delete-user.svg" height="13px" width="13px"
                              (click)="openAlert('deleteActivity', activityIndex, chapter);$event.stopPropagation();"
                              title="Delete activity" class="closeActivity ml-2"
                              [ngClass]="{invisible : chapter.activities.length < 3, 'viewOnly': (view && !create && !update)}">
                          </span>
                          <span [ngClass]="{'viewOnly': (view && !create && !update)}" *ngIf="!activity.activityType && chapter.chapterType === 'text'"
                            class="addActivityCls ">
                            <button (click)="addActivity($event, chapter, chapterIndex)" type="button"
                              class="btn courseContentDetails d-block addActivity"
                              [disabled]="!isChapterValid(chapter) || (view && !create && !update)">
                              + Add activity </button>
                          </span>

                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="rightSideContent px-2">
                  <span class="chaptersContents text-center d-block">Contents</span>
                  <div class="formattingCourse">
                    <!-- Text -->
                    <div class="">
                      <!-- If selected type is Text&Image -->
                      <div *ngIf="selectedChapter.chapterType === 'text'" class="">
                        <form class="form-inline d-block">
                          <div class="row">
                            <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 editorDropdown pl-0 p-0">
                              <!-- quiz dropdown -->
                              <div
                                class="form-group d-block align-items-center mb-0 editorCls justify-content-end pt-0">
                                <!-- quiz dropdown -->
                                <!-- selected content -->
                                <div class="">
                                  <!-- If selected activity type is Text -->
                                  <div *ngIf="selectedActivity.activityType === 'text'">
                                    <ckeditor [editor]="Editor"
                                      [name]="'editor' + selectedChapter.chapterId + '-'+  selectedActivity.activityId"
                                      [(ngModel)]="selectedActivity.content" class="editorFormatCls">
                                    </ckeditor>
                                    <!-- <angular-editor [name]="'editor' +  selectedActivity.activityId"
                                    [(ngModel)]="selectedActivity.content" [config]="angularEditorConfig"
                                    class="editorFormatCls">
                                  </angular-editor> -->
                                  </div>

                                  <!-- If selected activity type is Example -->
                                  <div *ngIf="selectedActivity.activityType === 'example'">
                                    <div class="">
                                      <div class="form-group row w-100 mb-3 px-2">
                                        <div class="col-sm-1">
                                          <label for="title" class="col-form-label fontBold">Title</label>
                                        </div>
                                        <div class="col-sm-11 p-0">
                                          <input type="text" [name]="'title' + selectedActivity.activityId"
                                            class="form-control exampleTitle w-100" id="title"
                                            [(ngModel)]="selectedActivity.title" placeholder="Enter Title">
                                        </div>
                                      </div>

                                      <div class="form-group row pl-3">
                                        <div class="col-sm-1">
                                          <label for="content" class="col-form-label fontBold pr-3"></label>
                                        </div>

                                        <div class="col-sm-11 pl-0 exampleEditor">
                                          <ckeditor [editor]="Editor"
                                            [name]="'content' + selectedChapter.chapterId + '-' +  selectedActivity.activityId"
                                            [(ngModel)]="selectedActivity.content"
                                            class="editorFormatCls exampleEditorCls"></ckeditor>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                                  <!-- If selected activity type is Quiz -->
                                  <div *ngIf="selectedActivity.activityType === 'quiz'" class="courseQuiz">
                                    <ng-container
                                      *ngTemplateOutlet="quizTemplate; context: {'config': { chapterData: selectedChapter, activityData: selectedActivity, type: 'activityQuiz' } }">
                                    </ng-container>
                                  </div>

                                  <!-- If selected activity type is Slide -->
                                  <div *ngIf="selectedActivity.activityType === 'slide'">
                                    <ng-container
                                      *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'activitySlide', accept: 'image/*' } }">
                                    </ng-container>
                                    <ng-container
                                      *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'activitySlide', object: selectedActivity } }">
                                    </ng-container>
                                  </div>

                                  <!-- video upload -->
                                  <div *ngIf="selectedActivity.activityType === 'video'">
                                    <ng-container
                                      *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'chapterFile', accept: 'video/*' } }">
                                    </ng-container>
                                    <ng-container
                                      *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'chapterFile',object: selectedActivity} }">
                                    </ng-container>
                                  </div>

                                  <!-- Audio upload -->
                                  <div *ngIf="selectedActivity.activityType === 'audio'">
                                    <ng-container
                                      *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'chapterFile', accept: 'mp3' } }">
                                    </ng-container>
                                    <ng-container
                                      *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'chapterFile',object: selectedActivity} }">
                                    </ng-container>
                                  </div>

                                </div>
                              </div>
                            </div>
                          </div>
                        </form>
                      </div>

                      <!-- File upload starts -->
                      <!-- If selected type is Slide -->
                      <div *ngIf="selectedChapter.chapterType === 'slide'">
                        <ng-container
                          *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'chapterSlide', accept: 'image/*' } }">
                        </ng-container>
                        <ng-container
                          *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'chapterSlide', object: selectedActivity } }">
                        </ng-container>
                      </div>

                      <!-- If selected type is FileUpload -->
                      <div *ngIf="selectedChapter.chapterType === 'fileUpload'" class="">
                        <ng-container
                          *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'chapterFile', accept: 'video/*,.mp3,.pdf' } }">
                        </ng-container>
                        <ng-container
                          *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'chapterFile',object: selectedChapter} }">
                        </ng-container>
                      </div>
                      <!-- File Upload end -->
                    </div>
                  </div>
                </div>
              </div>
              <div *ngIf="courseConfig.code === courseCode.SlideShow"
                class="row pl-3 pr-0 flex-nowrap textEditorArea flex-column">
                <ng-container
                  *ngTemplateOutlet="fileUploadTemplate; context: { 'config': { content: selectedActivity.content, type: 'slideShow', accept: '.pdf,.ppt,.pptx' } }">
                </ng-container>
                <div class="mb-3">
                  <a [ngClass]="{'viewOnly': (view && !create && !update)}" *ngIf="selectedActivity.content?.length > 0" class="remove-media-txt float-right"
                    (click)="selectedActivity.content = []; uploadFileInput.nativeElement.value= ''"> Remove all</a>
                </div>
                <ng-container
                  *ngTemplateOutlet="fileTableTemplate; context: { 'config': { fileData: selectedActivity.content, type: 'slideShow',object: selectedChapter} }">
                </ng-container>
              </div>
            </ng-container>

            <div *ngIf="selectedForm === 'checklist'" class="checklistCls row">
              <div class="col-sm-6 pr-0">
                <span class="checklistHeading"> Topic </span>
                <div [ngClass]="{'viewOnly': (view && !create && !update)}" cdkDropList [cdkDropListData]="course.chapters" (cdkDropListDropped)="drop($event)"
                  class="checklistDiv">
                  <div [ngClass]="{'selectedTopic' : selectedChapter.chapterId === chapter.chapterId}"
                    *ngFor="let chapter of course.chapters, let chapterIndex = index"
                    (click)="topicHighlight(chapter, chapterIndex)"
                    class="topicCls d-flex align-items-center justify-content-center">
                    <div cdkDrag *ngIf="chapter.chapterType" class="chaptersTopic">
                      <svg width="7" height="13" viewBox="0 0 7 13" fill="none" xmlns="http://www.w3.org/2000/svg"
                        class="topicSvg">
                        <path d="M3.5 12.5L0 7.5H7L3.5 12.5Z" fill="#818181" />
                        <path d="M3.5 0.5L0 5.5H7L3.5 0.5Z" fill="#818181" />
                      </svg>

                      <!-- <mat-icon class="m-0 tableIcons">unfold_more</mat-icon> -->
                      <label *ngIf="chapter.topicEditable && chapter.content" class="d-flex align-items-center w-100 mb-0 topicActiveLbl">{{chapter.content}}</label>
                      <input [id]="chapterIndex + '-input'" *ngIf="!chapter.topicEditable" autofocus="true" (focusout)="chapter.content.length !== 0 && chapter.topicEditable = true" [(ngModel)]="chapter.content" placeholder="Enter a topic title..." />
                      <!-- <img src="assets/images/delete-user.svg" height="13px" width="13px"
                        (click)="openAlert('deleteChapter', chapterIndex, chapter)" class="ml-2 mb-0 closeActivity"
                        (click)="openAlert('deleteChapter', chapterIndex, chapter)" class="ml-2 mb-0 closeActivity"
                        [ngClass]="{invisible : course.chapters.length < 3}" title="Delete Chapter"> -->
                      <a [ngClass]="{invisible : !chapter.topicEditable || !chapter.content, topicEditIconActive: selectedChapter.chapterId === chapter.chapterId}" [matMenuTriggerFor]="statusButton" class="statusHighlight topicEditIcon">
                        &#65049;
                      </a>
                      <mat-menu #statusButton="matMenu" class="newCoursePopup statusPopup checklistPopup editCheckPopup">
                        <div class=" p-0 coursePopup">
                          <!-- <div class="arrow1"></div> -->
                          <div>
                            <div class="d-flex justify-content-start align-items-center courseMenu"
                              mat-menu-item>
                              <button (click)="chapter.topicEditable = false; focusInput(chapterIndex+'-input')" class=" d-flex justify-content-start" mat-menu-item
                                data-target="#statusModal" data-toggle="modal">Edit</button>
                            </div>
                            <div class="d-flex justify-content-start align-items-center courseMenu"
                              mat-menu-item>
                              <button (click)="openAlert('deleteChapter', chapterIndex, chapter)" class=" d-flex justify-content-start deleteList" mat-menu-item
                                data-target="#statusModal" data-toggle="modal">Delete</button>
                            </div>
                          </div>
                        </div>
                      </mat-menu>
                    </div>
                    <button *ngIf="!chapter.chapterType" (click)="addTopic(chapterIndex+'-input')" [disabled]="!areChaptersValid()"> Add a
                      topic </button>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 p-0">
                <span class="checklistHeading checkLst"> Checklist </span>
                <div [ngClass]="{'viewOnly': (view && !create && !update)}" cdkDropList [cdkDropListData]="selectedChapter.activities" (cdkDropListDropped)="drop($event)"
                  class="checklistDiv ml-1 ">
                  <div *ngFor="let activity of selectedChapter.activities, let activityIndex = index"
                    class="topicCls checkCls d-flex align-items-center justify-content-center">
                    <div cdkDrag *ngIf="activity.activityType" class="chaptersTopic">
                      <svg width="7" height="13" viewBox="0 0 7 13" fill="none" xmlns="http://www.w3.org/2000/svg"
                        class="topicSvg">
                        <path d="M3.5 12.5L0 7.5H7L3.5 12.5Z" fill="#818181" />
                        <path d="M3.5 0.5L0 5.5H7L3.5 0.5Z" fill="#818181" />
                      </svg>
                      <input readonly [value]="activity.content" *ngIf="activity.topicEditable && activity.content" class="d-flex align-items-center w-100 mb-0 topicActiveLbl">
                      <input [id]="activityIndex + '-input'" *ngIf="!activity.topicEditable" autofocus="true" (focusout)="activity.content.length !== 0 && activity.topicEditable = true" [(ngModel)]="activity.content"  placeholder="Add an item..." />
                      <a [ngClass]="{invisible : !activity.topicEditable || !activity.content}" [matMenuTriggerFor]="statusButton" class="statusHighlight topicEditIcon">
                        &#65049;
                      </a>
                      <mat-menu #statusButton="matMenu" class="newCoursePopup statusPopup checklistPopup editCheckPopup">
                        <div class=" p-0 coursePopup">
                          <!-- <div class="arrow1"></div> -->
                          <div>
                            <div class="d-flex justify-content-start align-items-center courseMenu"
                              mat-menu-item>
                              <button (click)="activity.topicEditable = false; focusInput(activityIndex+'-input')" class="d-flex justify-content-start" mat-menu-item
                                data-target="#statusModal" data-toggle="modal">Edit</button>
                            </div>
                            <div class="d-flex justify-content-start align-items-center courseMenu"
                              mat-menu-item>
                              <button (click)="openAlert('deleteActivity', activityIndex, selectedChapter);$event.stopPropagation();" class="d-flex justify-content-start deleteList" mat-menu-item
                                data-target="#statusModal" data-toggle="modal">Delete</button>
                            </div>
                          </div>
                        </div>
                      </mat-menu>
                      <!-- <img src="assets/images/delete-user.svg" height="13px" width="13px"
                        (click)="openAlert('deleteActivity', activityIndex, selectedChapter);$event.stopPropagation();"
                        title="Delete activity" class="closeActivity ml-2"
                        [ngClass]="{invisible : selectedChapter.activities.length < 3}"> -->
                    </div>
                    <button *ngIf="!activity.activityType" (click)="addChecklist(activityIndex+'-input')"
                      [disabled]="!isChapterValid(selectedChapter)"> Add a checklist </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Questionaire -->
            <ng-container *ngIf="selectedForm === 'questionaire' && courseConfig.quiz">
              <div class="d-flex justify-content-between ">
                <div class="d-flex">
                  <div *ngIf="course.chapters.length > 5" class="prev ml-2 prev1" (click)="scrollRight('quizChapters', 83)">
                  </div>

                  <div id="quizChapters" class="btn-group mr-2 mb-3 d-flex chapterCount" role="group"
                    aria-label="First group">
                    <ng-container *ngFor="let chapter of course.chapters, let chapterIndex = index">
                      <button (click)="selectedQuestionnaire = chapter; selectedQuestionnaireIndex = chapterIndex; updateQuestionLimit(); quizChapterChange(chapterIndex)" type="button"
                        [ngClass]="{active: selectedQuestionnaire.chapterId === chapter.chapterId}"
                        class="btn courseContentDetails chapterDetails" *ngIf="chapter.chapterType">Chapter
                        {{chapter.chapterId}}</button>
                    </ng-container>

                  </div>
                  <div (click)="scrollLeft('quizChapters', 83)" class="next next1"
                    [ngClass]="{invisible: course.chapters.length < 6}">
                  </div>
                </div>
                <div class="float-right d-flex justify-content-end w-100  align-items-center randomTxt">
                  <span class="quizAtDD d-flex align-items-center">
                    <ng-container *ngIf="courseTypeDetail.courseTypeCode !== courseCode.SlideShow && courseConfig.code !== courseCode.F2F">
                      <label class="randomQuestion randomCls"> Quiz at</label>
                      <ng-select (click)="policyGroupOnClick()" class="" [items]="quizPositionItems" name="quizPosition" bindLabel="name" bindValue="key"
                        (change)="quizPositionChange()" [clearable]=false [searchable]="false" [(ngModel)]="quizPosition"> </ng-select>
                    </ng-container>
                  </span>
                  <label class="randomQuestion randomCls"> Random question</label>
                  <ng-select (click)="policyGroupOnClick()" [items]="questionLimit" name="randomQuestion" (change)="setQuestionLimit($event)" [clearable]=false
                    [searchable]="false" [(ngModel)]="randomLimit"> </ng-select>
                </div>
              </div>
              <ng-container
                *ngTemplateOutlet="quizTemplate; context: {'config': { chapterData: selectedQuestionnaire, activityData: selectedQuestionnaire, type: 'chapterQuiz' } }">
              </ng-container>
            </ng-container>

            <!-- Completion Message -->
            <!-- <div *ngIf="selectedForm === 'completionMessage' && courseConfig.completionMessage"
              class="completionMessageCls">
              <ckeditor [editor]="Editor" name="completionObject" [(ngModel)]="completionObject.content"
                class="editorFormatCls"></ckeditor>
            </div> -->

            <div *ngIf="selectedForm === 'completionMessage' && courseConfig.completionMessage"
              class="completionMessageCls">
                
              <div *ngIf="courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues()" (click)="policyGroupOnClick()" class="btn-group mr-2 courseGroupCls mb-2" role="group" aria-label="First group">
                <ng-container *ngFor="let item of completionCategories">
                  <button type="button" [ngClass]="{active: item.id === selectedCompletionType.id}" class="btn courseContentDetails"
                  (click)="compCategoryChange(item)"> {{item.name}} </button>
                </ng-container>
              </div>
              <div class="d-flex align-items-center completionTemplate" >
                <!-- Comp category (Only for F2F) -->
                <!-- <ng-select *ngIf="courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues()" (click)="policyGroupOnClick()" [items]="completionCategories" name="compCategory" [searchable]=true [clearable]=false
                                [(ngModel)]="selectedCompletionType.id" bindLabel="name" bindValue="id" (change)="compCategoryChange($event)"
                                class="completionSelect mt-3 mr-2"></ng-select> -->
                <label class="mb-0 mr-2"> Template name: </label>
                <ng-container
                  *ngIf="courseConfig.code !== courseCode.F2F || !(courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues())">
                  <ng-select (click)="policyGroupOnClick()" [items]="compTemplates" name="templateName" [searchable]=true
                    [clearable]=false [(ngModel)]="compTemplateObj.id" bindLabel="title" bindValue="id"
                    (change)="templateChange($event, 'normal')" class="completionSelect mt-3 mr-2"></ng-select>
                  <input [ngClass]="{'viewOnly': (view && !create && !update)}" class="completeInput p-1"
                    [(ngModel)]="compTemplateObj.title" />
                </ng-container>
                
                <ng-container *ngIf="courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues()">
                  <ng-select [disabled]="disableTemplateDD" (click)="policyGroupOnClick()" [items]="compCategoryTemplates" name="templateName" [searchable]=true
                    [clearable]=false [(ngModel)]="selectedCompletionType.templateId" bindLabel="title" bindValue="id"
                    (change)="templateChange($event, 'freeText')" class="completionSelect mt-3 mr-2"></ng-select>
                  <input [ngClass]="{'viewOnly': (view && !create && !update)}" class="completeInput p-1"
                    [(ngModel)]="selectedCompletionType.title" />
                </ng-container>
                <span class="completionName"> *Please provide the name to save the completion message template. </span>
              </div>

              <div [ngClass]="{'viewOnly': (view && !create && !update)}">
                <!-- Template content for normal flow -->
                <ckeditor *ngIf="courseConfig.code !== courseCode.F2F || !(courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues())" [editor]="Editor" name="completionObject"
                  [(ngModel)]="completionObject.content" class="editorFormatCls"></ckeditor>
                <!-- Template content for F2F free text flow -->
                <ckeditor *ngIf="courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues()" [editor]="Editor"
                  name="completionObject" [(ngModel)]="selectedCompletionType.content" class="editorFormatCls">
                </ckeditor>
              </div>
            </div>

            <ng-container *ngIf="selectedForm === 'pdfCertification'">
              <div class="cert-page-container-top">
                <div id="table" class="cert-container">
                  <table>
                    <thead>
                      <tr class="borderTr">
                        <th *ngFor="let column of certificationItemTableColumns">
                          <tr>
                            <div class="d-flex">
                              <span>{{column.name}}</span>                                       
                            </div>
                          </tr>
                        </th>
                        <th style="width: 100%;"></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let certItem of certificationItems; let certItemIndex = index">
                        <ng-container>
                          <!-- Default -->
                          <td class="tdDefault">
                            <mat-icon *ngIf="certItemIndex === 0" alt="default" title="default">check_circle_outline</mat-icon>
                          </td>
                          <!-- Locations -->
                          <td>

                            <div>
                              <mat-form-field appearance="fill" class="roleDropdown certificateMatformfield" [ngClass]="{appliedFilter: getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') > 0}">
                                
                                <mat-label *ngIf="getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') < 1"> Select Countries / Regions / Stores </mat-label>
                                
                                <mat-label *ngIf="getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') > 0" class="levelSelected">
                                  {{getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') + ' stores selected'}} </mat-label>
            
                                <mat-select class="roleSelectionCls" (openedChange)=" updateSelectionStatusOnCertItemChange($event, certItem, certItemIndex)">
            
                                  <!-- <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update) && certItemIndex === 0}" id="all" class="w-100 allCheckbox countryCheckbox" name="allCountries"
                                    (change)="selectAll($event, certItem.renderingData.countryList, 'certCountry'); calcSelectedStore();">
                                    All</mat-checkbox> -->
            
                                  <mat-tree [dataSource]="certItem.renderingData.countryList" [treeControl]="treeControl" class="example-tree">
            
                                    <mat-option class="disableRipple">
                                      <!-- This is the tree node template for leaf nodes -->
                                      <mat-nested-tree-node *matTreeNodeDef="let node">
                                        <li *ngIf="node.show" class="mat-tree-node">
                                          <!-- use a disabled button to provide padding for tree leaf -->
                                          <button mat-icon-button disabled></button>
                                          <mat-checkbox [disabled]="this.getSelectedChildCount(this.certificationItems[0].renderingData.countryList, 0, 'cert') === 1 && node.selectStatus === 'unchecked'" [ngClass]="{'viewOnly': (view && !create && !update) || certItemIndex === 0}" class="ml-3"
                                            (change)="selectionToggleLeaf($event.checked, node, 'certCountry', certItem); calcSelectedStore();"
                                            [checked]="node.selectStatus === 'checked'">{{node.desc}}</mat-checkbox>
                                        </li>
                                      </mat-nested-tree-node>
                                      <!-- This is the tree node template for expandable nodes -->
                                      <mat-nested-tree-node *matTreeNodeDef="let node; when: treeHasChild">
                                        <ul>
                                          <li *ngIf="node.show">
                                            <div class="mat-tree-node">
                                              <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.desc">
                                                <mat-icon class="mat-icon-rtl-mirror m-0 roleIcon">
                                                  {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                                                </mat-icon>
                                              </button>
                                              <!-- <mat-checkbox [ngClass]="{'viewOnly': (view && !create && !update) || certItemIndex === 0}"
                                                (change)="selectionToggle($event.checked, node, 'certCountry'); calcSelectedStore();"
                                                [indeterminate]="node.selectStatus === 'mixed'"
                                                [checked]="node.selectStatus === 'checked'">
                                                {{node.desc}}</mat-checkbox> -->
                                                <div class="locMasterNode">{{node.desc}}</div>
                                            </div>
                                            <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                                              <ng-container matTreeNodeOutlet></ng-container>
                                            </ul>
                                          </li>
                                        </ul>
                                      </mat-nested-tree-node>
                                    </mat-option>
                                  </mat-tree>
                                </mat-select>
                              </mat-form-field>
                            </div>
                          </td>
                          <!-- Certificates -->
                          <td>
                            <div [ngClass]="{'disableClass': getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') === 0}" class="cert-select-container">
                              <div [matMenuTriggerFor]="certificatesDD" [ngClass]="{'no-cursor' : isDisabled}" class="cert-select">
                                <div *ngIf="certItem.name.length === 0" class="selected-cert-options placeholder d-flex justify-content-between">
                                  Select certificate...
                                </div>
                                <div *ngIf="certItem.name.length > 0" class="selected-cert-options d-flex justify-content-between">
                                  {{certItem.name}}
                                </div>
                              </div>
                            </div>
            
                            <mat-menu #certificatesDD="matMenu" panelClass="table-menu-class" class="tableMatmenu">
                    
                              <div class=" p-0 coursePopup">
                                <div>
                                  <div *ngFor="let certificate of certificates"
                                    class=" d-flex justify-content-start  align-items-center courseMenu" mat-menu-item>
                                    <button (click)="onCertificateChange(certificate, certItem)" class="d-flex justify-content-start"
                                      mat-menu-item>{{certificate.name}}</button>
                                  </div>
                                </div>
                              </div>
                            </mat-menu>
                          </td>
                          <!-- Preview -->
                          <td>
                            <div style="margin-bottom: 10px;">
                            <a *ngIf="certItem.id !== 9" [ngClass]="{'disableClass': certItem.name.length === 0}" (click)="viewCertificate(certItem)">Preview</a>
                           </div>
                          </td>
                          <!-- Delete -->
                          <td>
                            <button class="certDeleteBtn"
                              [ngClass]="{'disableClass': certItem.name.length === 0 && !(certItem.name.length === 0 && getSelectedChildCount(certItem.renderingData.countryList, 0, 'cert') === 0)}"
                              *ngIf="certItemIndex !== 0" (click)="onDeleteButtonClick(certItemIndex, certItem)">
                              <img src="assets/images/delete-user.svg" height="20px" width="20px">
                            </button>
                          </td>
                        </ng-container>
                      </tr>
                      <!-- Add button -->
                     
                    </tbody>
                  </table>
                    <button [disabled]="(!certificationItems[certificationItems.length - 1].id || !certificates.length || calcSelectedStore() === 1) || (this.getSelectedChildCount(this.certificationItems[0].renderingData.countryList, 0, 'cert') === 1)" (click)="addCertItem()" class="btn btn-primary mt-2">Add</button>
                </div>
              </div>              
            </ng-container>

            <!-- Common buttons -->
            <!-- <button class="btn btn-primary" (click)="createUpdateCertificateList()">CLick</button> -->
          </div>
        </div>
      </div>
      <div class="saveSubmitCourse" *ngIf="selectedForm">
        <div class="">
          <!-- selectedLevelCount < 1 || !areCountriesSelected() ||  -->
          <!-- selectedLevelCount < 1 || !areCountriesSelected() ||  -->
          <button class="saveDraft float-left" [disabled]="!course.externalCourseName || (view && !create && !update)"
            (click)="alertBeforeSubmit(false)" [title]="!course.externalCourseName ? 'Please fill name' : ''">
            Save Draft </button>
          <button class="submitCourse ml-2" [disabled]="submitButton() || (view && !create && !update)" (click)="alertBeforeSubmit(true)"
            [title]="enableSubmitButton() ? '' : 'Please fill all the mandatory fields'">
            Submit Course </button>
        </div>
      </div>
    </div>
    <!-- Mobile view -->
    <div class=" previewContent d-flex align-item-center">
      <div class="smartphone">
        <div class="content p-0">
          <header class="headerDiv">
            <div class="form-group d-flex flex-nowrap align-items-center mb-0  headerCourse">
              <div class="float-left searchby-dd  d-flex">
                <mat-icon class="matArrow pl-2">arrow_back</mat-icon>
              </div>
              <div class="align-content-center searchby-dd  headerContent">
                <span class="courseNameCls">{{courseConfig.code === courseCode.Checklist ?
                  selectedChapter.content : course.externalCourseName}}</span>
              </div>
            </div>

            <div *ngIf="courseConfig.code !== courseCode.Checklist"
              class="d-flex previewPages justify-content-between align-items-center mx-2">
              <div (click)="scrollRight('quizPreviewChapters', 290)" [ngClass]="{invisible: course.chapters.length < 6}"
                class="prev pl-2"></div>
              <div id="quizPreviewChapters" class="pageViews d-flex justify-content-around">
                <ul class="nav nav-tabs border-0 flex-nowrap" role="tablist">
                  <ng-container *ngIf="courseConfig.courseContent">
                    <ng-container *ngFor="let chapter of course.chapters; let i = index">
                      <li class="nav-item pageTotal" (click)="goToPage(i)" *ngIf="chapter.chapterType">
                        <!-- [ngClass]="{isActive: currentPage === i}" -->
                        <!-- <a class="nav-link pageCount" data-toggle="tab" role="tab">
                          <span *ngIf="courseConfig.code !== courseCode.SlideShow"> {{chapter.chapterId}} </span>
                          <img *ngIf="courseConfig.code === courseCode.SlideShow" src="assets/images/ppt.png"
                            width="14px" height="14px" />
                        </a> -->
                        <div class="chapterActive" [ngClass]="{'readingChapter': currentPage === i}"></div>
                      </li>
                    </ng-container>
                  </ng-container>
                  <ng-container *ngIf="course.quizPosition && courseConfig.quiz">
                    <li class="nav-item pageTotal" (click)="goToPage(course.chapters.length - 1)">
                      <!-- [ngClass]="{isActive: currentPage === course.chapters.length - 1}" -->
                      <!-- <a class="nav-link pageCount" data-toggle="tab" role="tab">
                        <span> ? </span>
                      </a> -->
                      <div class="chapterActive"
                        [ngClass]="{'readingChapter': currentPage === course.chapters.length - 1}">
                      </div>
                    </li>
                  </ng-container>
                  <!-- Ouiz completion -->
                  <!-- <ng-container *ngIf="courseConfig.quiz">
                    <li class="nav-item pageTotal" (click)="goToPage(course.chapters.length)">
                      <!-- [ngClass]="{isActive: currentPage === course.chapters.length}"
                      <!-- <a class="nav-link pageCount" data-toggle="tab" role="tab">
                        <span> ! </span>
                      </a>
                      <div class="chapterActive" [ngClass]="{'readingChapter': currentPage === course.chapters.length}">
                      </div>
                    </li>
                  </ng-container> -->
                  <ng-container *ngIf="courseConfig.completionMessage">
                    <li class="nav-item pageTotal" (click)="goToPage(course.chapters.length + 1)">
                      <!-- [ngClass]="{isActive: currentPage === course.chapters.length + 1}" -->
                      <!-- <a class="nav-link pageCount" data-toggle="tab" role="tab">
                        <span>
                          <img src="assets/images/flag.svg" width="11px" height="11px">
                        </span>
                      </a> -->
                      <div class="chapterActive"
                        [ngClass]="{'readingChapter': currentPage === course.chapters.length + 1}"></div>
                    </li>
                  </ng-container>
                  <ng-container *ngIf="courseConfig.code !== courseCode.Policies">
                    <li (click)="goToPage(course.chapters.length + 2)" class="nav-item pageTotal">
                      <!-- [ngClass]="{isActive: currentPage === course.chapters.length + 2}" -->
                      <!-- <a #cert class="nav-link pageCount" data-toggle="tab" role="tab">
                        <img width="14px" height="14px" src="./assets/images/certIcon.png" alt="~"></a> -->
                      <div class="chapterActive"
                        [ngClass]="{'readingChapter': currentPage === course.chapters.length + 2}"></div>
                    </li>
                  </ng-container>
                </ul>
              </div>
              <div (click)="scrollLeft('quizPreviewChapters', 290)" [ngClass]="{invisible: course.chapters.length < 6}"
                class="next pr-2"></div>
            </div>
          </header>
          <ngx-ui-loader [loaderId]="'preview-loader'"></ngx-ui-loader>
          <section class="quizSection previewQuiz ck-content" ngxUiLoaderBlurred [loaderId]="'preview-loader'"
            [ngClass]="{'quizPortion p-2': currentPage === course.chapters.length - 1, 'p-2': currentPage > course.chapters.length - 2 || course.chapters[currentPage]?.activities[0]?.activityType !== 'pdf', 'slideBG': courseConfig.code === courseCode.SlideShow && currentPage === 0}">
            <div class="previewSection">
              <!-- [ngClass]="currentPage === course.chapters.length + 1 && completionObject.content ? 'completionSection' : 'previewSection'" -->
              <ng-container *ngIf="(course.quizPosition && currentPage < course.chapters.length - 1) || (currentPage < course.chapters.length - 1 && !course.quizPosition && selectedForm !== 'questionaire')">
                <ng-container *ngFor="let activity of course.chapters[currentPage].activities">

                  <!-- Text -->
                  <ng-container *ngIf="activity.activityType === 'text'">
                    <ng-container *ngTemplateOutlet="textPreview; context: { config : activity }">
                    </ng-container>
                  </ng-container>

                  <!-- Example -->
                  <ng-container *ngIf="activity.activityType === 'example'">
                    <ng-container *ngTemplateOutlet="examplePreview; context: { config : activity }">
                    </ng-container>
                  </ng-container>

                  <!-- Quiz -->
                  <ng-container *ngIf="activity.activityType === 'quiz'">{{setTotalQuestions()}}
                    <div [ngClass]="{'activityQuestion': activity.questions[0]?.content}">
                      <ng-container *ngTemplateOutlet="quizPreview; context: { config: activity}">
                      </ng-container>
                    </div>
                  </ng-container>


                  <!-- Slide -->
                  <ng-container *ngIf="activity.activityType === 'slide'">
                    <ng-container *ngTemplateOutlet="slidePreview; context: { config: activity}" class="activitySlide">
                    </ng-container>
                  </ng-container>

                  <!-- PDF -->
                  <ng-container *ngIf="activity.activityType === 'pdf'">
                    <ng-container *ngTemplateOutlet="pdfPreview; context: { config : activity}">
                    </ng-container>
                  </ng-container>

                  <!-- Video -->
                  <ng-container *ngIf=" activity.activityType==='video'">
                    <ng-container *ngTemplateOutlet="videoPreview; context: { config :activity}">
                    </ng-container>
                  </ng-container>

                  <!-- Audio -->
                  <ng-container *ngIf=" activity.activityType==='audio'">
                    <ng-container *ngTemplateOutlet="audioPreview; context: { config :activity}">
                    </ng-container>
                  </ng-container>

                  <!-- PPT -->
                  <ng-container *ngIf=" activity.activityType==='ppt'">
                    <ng-container *ngTemplateOutlet="pptPreview; context: { config :activity}">
                    </ng-container>
                  </ng-container>

                  <!-- slideshow -->
                  <div class="slideShowImg">
                    <ng-container *ngIf="activity.activityType === 'slideShow'">
                      <ng-container *ngTemplateOutlet="slidePreview; context: { config : activity }">
                      </ng-container>

                    </ng-container>
                  </div>

                  <!-- Checklist -->
                  <div class="checklistPreview">
                    <ng-container *ngIf="activity.activityType === 'checklist'">
                      <ng-container *ngTemplateOutlet="checklistPreview; context: { config :activity}">
                      </ng-container>
                    </ng-container>
                  </div>
                </ng-container>
              </ng-container>

              <!-- Questionnaire -->
              <ng-container *ngIf="(course.quizPosition && currentPage === course.chapters.length - 1) || (!course.quizPosition && selectedForm === 'questionaire' && currentPage < course.chapters.length)">
                <div class="quizHintCls">
                  <h3 *ngIf="!checkFreeTextQues()" class="quizTimeHeading">Quiz time!</h3>
                  <h3 *ngIf="checkFreeTextQues()" class="quizTimeHeading">Write up assesment</h3>
                  <p *ngIf="checkFreeTextQues()" class=" hintCls">Hint: you can always reference the course for clues!</p>
                </div>{{setTotalQuestions()}}
                <ng-container *ngIf="course.quizPosition">
                  <ng-container *ngFor="let chapter of course.chapters">
                    <ng-container *ngTemplateOutlet="quizPreview; context: { config : chapter }">
                    </ng-container>
                  </ng-container>
                </ng-container>
                <ng-container *ngIf="!course.quizPosition">
                  <ng-container *ngTemplateOutlet="quizPreview; context: { config : course.chapters[currentPage] }">
                  </ng-container>
                </ng-container>
              </ng-container>

              <!-- Quiz completion -->
              <ng-container *ngIf="currentPage === course.chapters.length">
                <ng-container *ngTemplateOutlet="quizCompletion">
                </ng-container>
              </ng-container>

              <!-- Completion Message -->
              <ng-container *ngIf="currentPage === course.chapters.length + 1">
                <ng-container *ngTemplateOutlet="textPreview; context: { config : courseConfig.code === courseCode.F2F && quizCount() > 0 && checkFreeTextQues() ? selectedCompletionType : completionObject}">
                </ng-container>
              </ng-container>
              <!-- certificate page -->
              <ng-container *ngIf="currentPage === course.chapters.length + 2">
                <ng-container *ngIf="courseConfig.code !== courseCode.F2F">
                  <div>
                    <img src="assets/images/sample-certificate.png" alt="Certificate" />
                  </div>
                  <div class="certificateDiv m-auto">
                    <button class="border-0 certificateBtn"><img src="./assets/images/certificate.svg" width="46px" height="31px"
                        class="mx-auto mb-2">
                      <span class="downloadCertificate">Download Certificate</span>
                      <hr class="homeDiv">
                      <div class="d-flex justify-content-center mx-auto homeScreen align-items-center mb-4">
                        <img src="assets/images/home.svg" class="mt-1 mr-2 mb-1" width="18px" height="18px">
                        <span>Go to home screen</span>
                      </div>
                    </button>
                
                  </div>
                </ng-container>

                <ng-container *ngIf="courseConfig.code === courseCode.F2F && previewData">
                  <pdf-viewer (after-load-complete)="pdfLoader('stop')"
                    [src]="previewData.certificateUrl" [zoom]="zoom" [rotation]="rotation"
                    [render-text]="true" [original-size]="false" [fit-to-page]="true" (page-rendered)="pageRendered($event)"
                    class="pdf slidePreview">
                  </pdf-viewer>
                </ng-container>
              </ng-container>
            </div>

            <div class="previewFooter align-content-center justify-content-center">
              <ng-container *ngIf="courseConfig.code !== courseCode.Checklist">
                <button class="nextChapBtn mt-2" *ngIf="(currentPage < course.chapters.length - 2) && course.quizPosition"> Next Chapter ->
                </button>
                <button class="nextChapBtn my-2" *ngIf="(course.quizPosition && currentPage === course.chapters.length - 2) || (!course.quizPosition && currentPage < course.chapters.length - 1) && selectedForm !== 'questionaire'">
                  {{ courseConfig.quiz || (!course.quizPosition && selectedForm !== 'questionaire') ? 'To quiz ->' : 'Done' }} </button>
                <button class="nextChapBtn my-2" *ngIf="!course.quizPosition && selectedForm === 'questionaire'"> Submit </button>
                <button class="doneChapterBtn my-2" *ngIf="course.quizPosition && currentPage === course.chapters.length - 1"> Done </button>
                <button class="submitChapterBtn mt-2" *ngIf="currentPage === course.chapters.length"> Confirm </button>
                <button class="confirmChapterBtn mt-2" *ngIf="currentPage === course.chapters.length + 1"> Confirm
                </button>
              </ng-container>
              <ng-container *ngIf="courseConfig.code === courseCode.Checklist && selectedChapter.activities[0].content">
                <div class="certificateDiv m-auto checkallList">
                  <span class="downloadCertificate">Check all</span>
                </div>
                <button class=" mt-2 completeTopicBtn"> <span>Complete the topic</span>
                </button>
              </ng-container>

              <!-- <div class="certificateDiv m-auto"
                *ngIf="currentPage === course.chapters.length + 1 && completionObject.content">
                <button class="border-0 certificateBtn"><img src="./assets/images/certificate.svg" width="46px"
                    height="31px" class="mx-auto mb-2">
                  <span class="downloadCertificate">Download Certificate</span>
                </button>
              </div> -->
            </div>
          </section>


        </div>
      </div>
    </div>
  </div>
</section>



<!-- Quiz template -->
<ng-template #quizTemplate let-config="config">
  <div class="questionCls">
    <div *ngFor="let question of config.activityData.questions; let questionIndex = index" class="questionaire">
      <div [ngClass]="{'viewOnly': (view && !create && !update)}">
        <div class="chapterOptions  mt-0">
          <div class="float-left">
            <span class="chapterList">Question {{question.questionId}}</span>
          </div>

          <div class="float-right d-flex align-items-center">
            <!-- Question Type DD(Available only for F2F) -->
            <ng-select *ngIf="courseConfig.code === courseCode.F2F" (change)="quizTypeOnChange(question)" [items]="questionTypes"
              [name]="'qType' + config.chapterData?.chapterId + question.questionId" bindValue="key" [clearable]=false
              [searchable]="false" bindLabel="name" [(ngModel)]="question.questionType">
            </ng-select>

            <span class="pb-3 pr-2 pl-2">|</span>

            <span class="form-check confirmCourse" *ngIf="config.type === 'chapterQuiz' && question.questionType !== 'fillRightAnswer' && question.questionType !== 'freeText'">
              <input (change)="updateQuestionLimit()"
                [name]="'mandatory' + config.chapterData?.chapterId + question.questionId" class="form-check-input "
                type="checkbox" [(ngModel)]="question.mandatory" required>
              <label class="form-check-label randomQuestion mb-3 mr-2 mandatoryLbl">
                Mandatory
              </label>
            </span>
            <!-- <ng-select (change)="quizTypeOnChange(question)" [items]="quizTypes"
              [name]="'qType' + config.chapterData?.chapterId + question.questionId" bindValue="key" [clearable]=false
              [searchable]="false" bindLabel="name" [(ngModel)]="question.questionType">
            </ng-select> -->
          </div>
        </div>

        <div>
          <ckeditor [editor]="Editor" [name]="'question' + questionIndex" [(ngModel)]="question.content"
            class="editorFormatCls">
          </ckeditor>
        </div>
        <div class="optionsList">
          <div class="form-group d-block mb-0">
            <!-- <div *ngIf="question.questionType === 'singleAnswer'">
              <div class="row align-items-center mb-3">
                <span class="ml-3 mb-3">Correct</span>
                <mat-radio-group [name]="'radioGrp' + config.chapterData?.chapterId + question.questionId"
                  [(ngModel)]="question.correctAnswer" class="col-12">
                  <mat-radio-button (change)="singleOptionChange(question.options, option)"
                    *ngFor="let option of question.options; let optionIndex = index" [value]="option.key" class="w-100">
                    <input (change)="$event.stopPropagation();" class="form-control" type="text"
                      [(ngModel)]="option.content"
                      [name]="'value' + config.chapterData?.chapterId + question.questionId + optionIndex">
                    <button *ngIf="question.options.length > 2" (click)="removeOption(question, optionIndex)"
                      class="removeBtn">
                      <mat-icon class="m-0 closeActivity answerDeleteCls">close</mat-icon>
                    </button>
                  </mat-radio-button>
                </mat-radio-group>
              </div>
            </div> -->
            <div class="multiAnswer w-100" *ngIf="question.questionType === 'multiAnswer' || question.questionType === 'singleAnswer'">
              <!-- <span class="mb-3">Correct</span> -->
              <div class="row align-items-center mt-2 mb-3 flex-nowrap "
                *ngFor="let option of question.options; let optionIndex = index">

                <mat-checkbox [name]="'optionCheckBox' + selectedActivity.activityId" [(ngModel)]="option.correctAnswer"
                  class="pl-3">
                </mat-checkbox>
                <input class="form-control calibri" type="text" [(ngModel)]="option.content"
                  [name]="'value' + config.chapterData?.chapterId + question.questionId + optionIndex">
                <button *ngIf="question.options.length > 2" class="col-4" (click)="removeOption(question, optionIndex)"
                  class="removeBtn">
                  <img src="assets/images/delete-user.svg" height="13px" width="13px"
                    class=" ml-2 m-0 closeActivity answerDeleteCls">

                </button>
              </div>
            </div>
            <!-- Re arrange order -->
            <div class="multiAnswer w-100" *ngIf="question.questionType === 'reArrangeOrder'">
              <div class="row align-items-center mt-2 mb-3 flex-nowrap "
                *ngFor="let option of question.options; let optionIndex = index">
                <span>{{optionIndex + 1}}</span>
                <input class="form-control calibri" type="text" [(ngModel)]="option.content"
                  [name]="'value' + config.chapterData?.chapterId + question.questionId + optionIndex">
                <button *ngIf="question.options.length > 2" class="col-4" (click)="removeOption(question, optionIndex)"
                  class="removeBtn">
                  <img src="assets/images/delete-user.svg" height="13px" width="13px"
                    class=" ml-2 m-0 closeActivity answerDeleteCls">
                </button>
              </div>
            </div>
            <!-- Fill in the blanks & Free text -->
            <div class="multiAnswer w-100" *ngIf="question.questionType === 'fillRightAnswer' || question.questionType === 'freeText'">
              <div class="d-flex align-items-center">
                <mat-checkbox [name]="'charLimitCheckBox' + selectedActivity.activityId" [(ngModel)]="question.characterLimitCheck"
                  class="pl-3"></mat-checkbox>
                <label class="mb-0">Character Limit</label>&nbsp;&nbsp;
                <input class="p-1" [disabled]="!question.characterLimitCheck" type="number" [(ngModel)]="question.characterLimit"
                [name]="'value' + config.chapterData?.chapterId + question.questionId + optionIndex">
              </div>
            </div>
            <div class="addDeleteQuestion w-100">
              <button *ngIf="!(question.questionType === 'fillRightAnswer' || question.questionType === 'freeText')" (click)="addOption(question)" class="addBtn float-left"
                [disabled]="disableAddOption(question)">ADD</button>
              <button class="mb-4 float-right btn-danger deleteQuestionBtn"
                (click)="removeQuestion(config.activityData.questions, questionIndex)">
                Delete</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Add questions -->
    <button [ngClass]="{'viewOnly': (view && !create && !update)}" class="mb-3 mt-3 addBtn addOptionalQuestion" (click)="addQuestion(config.activityData.questions)"
      [disabled]="!areQuestionnaireValid(config.activityData.questions)">
      Add a question (optional)</button>
  </div>
</ng-template>


<!-- Show File in table template -->
<ng-template #fileTableTemplate let-config="config">
  <div class="media-upload-table-container" *ngIf="config.fileData?.length > 0">
    <table class="media-upload-table table table-borderless">
      <thead>
        <tr>
          <th *ngIf="config.type === 'slideShow'">Chapter</th>
          <th></th>
          <th class="chapterHeader"></th>
          <th class="media-progress-bar"></th>
          <th class="chapterMedia"></th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let media of config.fileData; let i = index">
          <td *ngIf="config.type === 'slideShow'"> {{i+1}}. </td>
          <td *ngIf="config.type !== 'chapterFile'">
            <img [src]="media.thumbImage" onerror="this.src='assets/images/no-image.png'" height="50" width="50"
              class="uploadedImage">
          </td>
          <td class="align-middle w-25">
            <div class="d-flex flex-row align-items-center">
              <div class="media-file-name">
                <span class="mediaNameCls">
                  {{ media.name }}
                </span>
              </div>
            </div>
          </td>
          <td class="removeImgCls">
            <a class="remove-media-txt" (click)="removeImage(i, config.type)"> Remove </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</ng-template>

<!-- Fileupload template -->
<ng-template #fileUploadTemplate let-config="config">
  <div [ngClass]="{'viewOnly': (view && !create && !update)}" class="fileupload d-block" appDragDropFileUpload (click)="uploadFileInput.click()"
    (fileDropped)="onFileBrowse($event ,'dragndropEvent', config.content, config.type)">
    <span class="ddinfo text-center d-flex align-items-center justify-content-center p-4">
      Choose a file </span>
    <input type="file" class="fileInputCls" (change)="onFileBrowse($event, 'fileUpEvent', config.content, config.type)"
      hidden multiple #uploadFileInput id="file" name="file" [accept]="config.accept" />
  </div>
</ng-template>


<!-- Activities Preview -->
<!-- Text -->
<ng-template #textPreview let-textConfig="config">
  <div class="calibri">
    <div [innerHTML]="(textConfig.content || '') | safe: 'html'">
    </div>
  </div>
</ng-template>

<!-- Accordian -->
<ng-template #examplePreview let-exampleConfig="config">
  <div class="exampleDivCls">
    <a *ngIf="exampleConfig.title" class="example mb-3" (click)="exampleConfig.isExpanded = !exampleConfig.isExpanded;">
      {{exampleConfig.isExpanded ? '[ - ]' : '[ + ]'}}
      {{exampleConfig.title}}</a>
    <mat-accordion>
      <mat-expansion-panel [expanded]="exampleConfig.isExpanded">
        <div [innerHTML]="(exampleConfig.content || '') | safe: 'html'" class="exampleDivCls calibri"></div>
      </mat-expansion-panel>
    </mat-accordion>
  </div>
</ng-template>

<!-- Checklist section -->
<ng-template #checklistPreview let-checklistConfig="config">
  <div class="checklistSelect courseContentCls">
    <mat-checkbox *ngIf="checklistConfig && checklistConfig.content" [name]="'clActivity' + checklistConfig.activityId">
      <span>{{checklistConfig.content}}</span>
    </mat-checkbox>
  </div>
  <!-- <ngx-doc-viewer *ngIf="checklistConfig?.content[0]?.url" disableContent="none" class="pptViewerCls w-100"
    style="height: 100vh;" [url]="imagePath + checklistConfig?.content[0]?.url">
  </ngx-doc-viewer> -->
</ng-template>

<!-- Quiz -->
<ng-template #quizPreview let-quizConfig="config"; let-print="print">
  <div class="quizDivCls">
    <!-- #quizForm="ngForm" id="quizFormId"  -->
    <div *ngIf="quizConfig.questions[0]?.content">
      <ng-container *ngFor="let question of quizConfig.questions || []; let i = index">
        <!-- MultiChoice question Block -->
        <!-- Question -->
        <div class="row previewQuestion question  mt-5 flex-nowrap align-items-center" [ngClass]="{previewQuestionforFill : question.questionType === 'fillRightAnswer' || question.questionType === 'freeText'}">
          <div [ngClass]="{'pdfQuiz': print}" class="d-flex questionDiv">
            <span *ngIf="print" class="quizSeries fontBold">{{i+1}}</span>
            <div [innerHTML]="(question.content || '') | safe: 'html'" class="fontBold questionContent calibri"></div>
          </div>
        </div>
        <!-- Single & Multi correct answers -->
        <ng-container *ngIf="question?.questionType === 'multiAnswer' ||question?.questionType === 'singleAnswer'">
          <!--  *ngIf="question?.questionType === 'multiAnswer'" -->
          <div class="answerSection" *ngFor="let answer of question?.options || []">
            <div *ngIf="answer.content" class="answerDiv d-flex">
              <mat-checkbox [(ngModel)]="answer.userAnswer" [name]="'multiChoice' + i" required>
              </mat-checkbox>
              <span [ngClass]="{selectedAnswer: answer.userAnswer, 'pdfQuiz': print}" class="calibri">
                {{answer.content}}
              </span>
            </div>
          </div>
        </ng-container>
        <!-- Re arrange order -->
        <ng-container *ngIf="question?.questionType === 'reArrangeOrder'">
          <label *ngIf="question.content" class="newyellowBG">drag and down to re-arrange the order</label>
          <div class="answerSection answerSection1" *ngFor="let answer of question?.options || []">
            <div *ngIf="answer.content" class="d-flex align-items-center answersubSection">
              <div>
              <svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <mask id="mask0_193_1986" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="24" height="25">
                <rect y="0.5" width="24" height="24" fill="#D9D9D9"/>
                </mask>
                <g mask="url(#mask0_193_1986)">
                <path d="M9.00012 20.1153C8.5559 20.1153 8.17562 19.9572 7.85927 19.6408C7.54293 19.3245 7.38477 18.9442 7.38477 18.5C7.38477 18.0558 7.54293 17.6755 7.85927 17.3591C8.17562 17.0428 8.5559 16.8846 9.00012 16.8846C9.44433 16.8846 9.82462 17.0428 10.141 17.3591C10.4573 17.6755 10.6155 18.0558 10.6155 18.5C10.6155 18.9442 10.4573 19.3245 10.141 19.6408C9.82462 19.9572 9.44433 20.1153 9.00012 20.1153ZM15.0001 20.1153C14.5559 20.1153 14.1756 19.9572 13.8593 19.6408C13.5429 19.3245 13.3848 18.9442 13.3848 18.5C13.3848 18.0558 13.5429 17.6755 13.8593 17.3591C14.1756 17.0428 14.5559 16.8846 15.0001 16.8846C15.4443 16.8846 15.8246 17.0428 16.141 17.3591C16.4573 17.6755 16.6155 18.0558 16.6155 18.5C16.6155 18.9442 16.4573 19.3245 16.141 19.6408C15.8246 19.9572 15.4443 20.1153 15.0001 20.1153ZM9.00012 14.1153C8.5559 14.1153 8.17562 13.9572 7.85927 13.6408C7.54293 13.3245 7.38477 12.9442 7.38477 12.5C7.38477 12.0558 7.54293 11.6755 7.85927 11.3591C8.17562 11.0428 8.5559 10.8846 9.00012 10.8846C9.44433 10.8846 9.82462 11.0428 10.141 11.3591C10.4573 11.6755 10.6155 12.0558 10.6155 12.5C10.6155 12.9442 10.4573 13.3245 10.141 13.6408C9.82462 13.9572 9.44433 14.1153 9.00012 14.1153ZM15.0001 14.1153C14.5559 14.1153 14.1756 13.9572 13.8593 13.6408C13.5429 13.3245 13.3848 12.9442 13.3848 12.5C13.3848 12.0558 13.5429 11.6755 13.8593 11.3591C14.1756 11.0428 14.5559 10.8846 15.0001 10.8846C15.4443 10.8846 15.8246 11.0428 16.141 11.3591C16.4573 11.6755 16.6155 12.0558 16.6155 12.5C16.6155 12.9442 16.4573 13.3245 16.141 13.6408C15.8246 13.9572 15.4443 14.1153 15.0001 14.1153ZM9.00012 8.11534C8.5559 8.11534 8.17562 7.95718 7.85927 7.64084C7.54293 7.32449 7.38477 6.94421 7.38477 6.49999C7.38477 6.05578 7.54293 5.67549 7.85927 5.35914C8.17562 5.04281 8.5559 4.88464 9.00012 4.88464C9.44433 4.88464 9.82462 5.04281 10.141 5.35914C10.4573 5.67549 10.6155 6.05578 10.6155 6.49999C10.6155 6.94421 10.4573 7.32449 10.141 7.64084C9.82462 7.95718 9.44433 8.11534 9.00012 8.11534ZM15.0001 8.11534C14.5559 8.11534 14.1756 7.95718 13.8593 7.64084C13.5429 7.32449 13.3848 6.94421 13.3848 6.49999C13.3848 6.05578 13.5429 5.67549 13.8593 5.35914C14.1756 5.04281 14.5559 4.88464 15.0001 4.88464C15.4443 4.88464 15.8246 5.04281 16.141 5.35914C16.4573 5.67549 16.6155 6.05578 16.6155 6.49999C16.6155 6.94421 16.4573 7.32449 16.141 7.64084C15.8246 7.95718 15.4443 8.11534 15.0001 8.11534Z" fill="#1C1B1F"/>
                </g>
                </svg>  
                </div>              
              <div class="answersubSectionContent">{{answer.content}}</div>
            </div>
          </div>
        </ng-container>
        <!-- Free text & Fill right -->
        <ng-container *ngIf="question?.questionType === 'fillRightAnswer' || question?.questionType === 'freeText'">
          <div *ngIf="question.content" class="freeTextInput" [ngClass]="{'bigfreeTextInput' :  question?.questionType === 'freeText'}"></div>
          <div *ngIf="question.characterLimit > 0" class="freeTextCount">0/{{question.characterLimit}}</div>
        </ng-container>
        <!-- Single correct answer -->
        <!-- <mat-radio-group *ngIf="question?.questionType === 'singleAnswer'" [name]="'singleAnswer' + i"
          [(ngModel)]="question.userAnswer" required>
          <div *ngFor="let answer of question?.options || []" class="answerDiv">
            <ng-container *ngIf="answer.content">
              <mat-radio-button class=" me-3" [value]="answer.content">
              </mat-radio-button>
              <span>
                {{answer.content}}
              </span>
            </ng-container>
          </div>
        </mat-radio-group> -->
      </ng-container>
      <span *ngIf="quizConfig.type === 'chapterQuiz' && quizConfig.questions?.length <= 1"> No Quiz
        available</span>
    </div>
  </div>
</ng-template>

<!-- Slider -->
<ng-template #slidePreview let-sliderConfig="config">
  <div class="slidePreview pdfImgSlide" *ngIf="sliderConfig?.content?.length > 0">
    <span [ngClass]="{'viewPresentationCls': courseConfig.code === courseCode.SlideShow}"
      class="fontBold d-flex justify-content-center align-items-center mb-1 mt-2"
      *ngIf="sliderConfig.content?.length > 0">
      {{courseConfig.code === courseCode.SlideShow ? 'Tap the image to start presentation' : 'Swipe the image to continue presentation'}}
    </span>
    <ng-image-slider [imagePopup]="courseConfig.code === courseCode.SlideShow" [images]="sliderConfig.content" [imageSize]="{width: '100%'}" slideImage="1">
    </ng-image-slider>
  </div>
</ng-template>

<!-- PDF section -->
<ng-template #pdfPreview let-pdfConfig="config">
  <div *ngIf="pdfConfig?.content[0]?.url">
    <!-- <div class="filePdf">
      <div class="pageButton d-flex justify-content-center align-content-center mt-2">
        <button class="nav-link pageCount" (click)="rotation = rotation - 90">
          <img src="./assets/images/rotate-left.png" alt="~" />
        </button>
        <button (click)="zoom = zoom - 0.05" class="zoomPage zoomOut"> - </button>
        <button (click)="zoom = zoom + 0.05" class="zoomPage zoomIn"> + </button>
        <button class="nav-link pageCount" (click)="rotation = rotation + 90">
          <img src="./assets/images/rotate-right.png" alt="~" />
        </button>
      </div> -->
    <pdf-viewer (after-load-complete)="pdfLoader('stop')" [src]="{url: pdfUrl + pdfConfig?.content[0]?.url, withCredentials: true}" [zoom]="zoom"
      [rotation]="rotation" [render-text]="true" [original-size]="false" [fit-to-page]="true"
      (page-rendered)="pageRendered($event)" class="pdf slidePreview">
    </pdf-viewer>
    <!-- <ngx-extended-pdf-viewer [src]="imagePath + pdfConfig?.content[0]?.url" backgroundColor="#ffffff"
      [useBrowserLocale]="true" [showSecondaryToolbarButton]="true" [showDownloadButton]="false"
      [showPrintButton]="false" [showOpenFileButton]="false" [showSpreadButton]="false" [showScrollingButton]="false"
      [showPropertiesButton]="false" [showPresentationModeButton]="true" [pageViewMode]="'infinite-scroll'"
      (pdfLoadingStarts)="pdfLoader('start')" (pdfLoaded)="pdfLoader('stop')" [showToolbar]="false">
    </ngx-extended-pdf-viewer> -->

  </div>
</ng-template>

<!-- Video section -->
<ng-template #videoPreview let-videoConfig="config">
  <iframe *ngIf="videoConfig?.content[0]?.url"
    [src]="utils.adminUrl + '?url=' + imagePath + videoConfig?.content[0]?.url | safe: 'resourceUrl'" allowfullscreen
    controlsList="nodownload" controls class="w-100 videoContent ">
  </iframe>
    <p class="text-center mt-0 videoTextCls">You will need to watch the full video before you can proceed</p>
  <!-- <video *ngIf="videoConfig?.content[0]?.url"
    [src]="imagePath + videoConfig?.content[0]?.url | safe: 'resourceUrl'" allowfullscreen
    controlsList="nodownload" controls class="w-100 mt-4 courseVideo">
  </video> -->
</ng-template>

<!-- Audio section -->
<ng-template #audioPreview let-audioConfig="config">
  <audio class="w-100 mb-1" controls controlsList="nodownload" *ngIf="audioConfig?.content[0]?.url">
    <source [src]="imagePath + audioConfig?.content[0]?.url">
    Your browser does not support the audio element.
  </audio>
</ng-template>

<!-- ppt section -->
<ng-template #pptPreview let-pptConfig="config">
  <ngx-doc-viewer *ngIf="pptConfig?.content[0]?.url" disableContent="none" class="pptViewerCls w-100"
    style="height: 100vh;" [url]="imagePath + pptConfig?.content[0]?.url">
  </ngx-doc-viewer>
</ng-template>

<!-- Quiz completion section -->
<ng-template #quizCompletion>
  <div class="donePage d-flex flex-column align-items-center justify-content-center">
    <span class="wellDoneTxt">Well Done !</span>
    <div class="doneImg">
      <img src="assets/images/oscar.svg" height="132px" width="132px" class="mb-0">
    </div>
    <span class="doneTxt">Please confirm that you have read and understand the course.</span>
  </div>
</ng-template>

<!-- Confirm popup -->
<button #confirmModal class="d-none" data-toggle="modal" data-target="#confirmModal"></button>
<div class="modal fade modalPopup checkDelModal" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-sml modal-dialog-centered" role="document">
    <div class="modal-content ">

      <!-- modal header -->
      <div class="modal-header">
        <!-- title -->
        <div class="confirmHeader">
          Alert
        </div>

        <!-- close icon -->
        <button type="button" class="close d-flex px-3 py-2" data-dismiss="modal" aria-label="Close">
          <mat-icon class="clr-white">close</mat-icon>
        </button>

      </div>
      <div class="modal-body d-flex align-items-center">

        <!-- modal content -->
        <div>
          <h6 class="mt-3"> {{alertModal.text}} </h6>
        </div>

      </div>
      <div class="modal-footer p-0 border-0 pb-3">
        <div class="m-0 w-100 d-flex justify-content-end">
          <button class="btn userDlgBtn cancelBtn float-right mr-2 saveDraft" data-dismiss="modal"> Cancel </button>
          <button (click)="alertConfirmed()" class="btn btn-primary newCourseBtn float-left mr-2"> Confirm </button>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- History popup -->
<button #historyModal class="d-none" data-toggle="modal" data-target="#historyModal"></button>
<div class="modal fade historyModal modalPopup" id="historyModal" tabindex="-1" role="dialog"
  aria-labelledby="historyModalLabel" aria-hidden="true" data-keyboard="false" data-backdrop='static'>
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content ">

      <!-- modal header -->
      <div class="modal-header">
        <!-- title -->
        <div class="confirmHeader">
          History
        </div>

        <!-- close icon -->
        <button type="button" class="close d-flex px-3 py-2" data-dismiss="modal" aria-label="Close">
          <mat-icon class="clr-white">close</mat-icon>
        </button>

      </div>
      <div class="modal-body py-3 px-1 align-items-center">

        <!-- modal content -->
        <div>
          <table mat-table [dataSource]="courseHistory" class="mat-elevation-z8 w-100 historyTbl">
            <ng-container *ngFor="let column of historyColumns">
              <ng-container [matColumnDef]="column.name">
                <th mat-header-cell *matHeaderCellDef>
                  <div class="d-flex flex-row justify-content-between">
                    <span> {{column.name}} </span>
                  </div>
                </th>
                <td mat-cell *matCellDef="let element">
                  <span *ngIf="column.property === 'createdDate'">
                    {{element[column.property] | dateUtcToLocal :utils.FORMAT.DATEM}}
                  </span>
                  <span *ngIf="column.property === 'chapterCount' && element.chapterCount > 0"
                    class="d-flex chapterHistory">
                    <ng-container *ngFor="let item of [].constructor(element.chapterCount); let i = index">
                      <span class="chapterNo" *ngIf="i < 9">
                        {{i+1}}
                      </span>
                      <span *ngIf="i > 10"> ... </span>
                      <span class="chapterNo" *ngIf="i === element.chapterCount - 1 && i > 9"> {{i+1}} </span>
                    </ng-container>
                  </span>

                  <span *ngIf="column.property === 'restore'" class="d-flex align-item-center">
                    <button [disabled]="(view && !create && !update)" (click)="getCourseDetails(element)" class=" restoreBtn">Restore</button>
                  </span>
                </td>
              </ng-container>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="historyColumnsToDisplay; sticky: true;"></tr>
            <tr mat-row *matRowDef="let row; columns: historyColumnsToDisplay;"></tr>
          </table>
        </div>

      </div>
    </div>
  </div>
</div>
<!-- <mat-menu #activityText="matMenu" xPosition="before" class="activityPopover">
  <div class="arrow"></div>
  <div class="summaryData">
    <div class="">
      <div>
        <div class="mb-2 d-flex justify-content-between" mat-menu-item>
          <span class="menuText p-0">Text</span>
        </div>
        <div class="mb-2 d-flex justify-content-between" mat-menu-item>
          <span class="menuText p-0">Expandable</span>
        </div>
        <div class="mb-2 d-flex justify-content-between" mat-menu-item>
          <span class="menuText p-0">Quiz</span>
        </div>
        <div class="mb-2 d-flex justify-content-between" mat-menu-item>
          <span class="menuText p-0">Slide</span>
        </div>
        <div class="mb-2 d-flex justify-content-between" mat-menu-item>
          <span class="menuText p-0">Video</span>
        </div>
      </div>
    </div>
  </div>

</mat-menu> -->




<div class="d-none">
  <!-- Course print section -->
  <div id="course-print-section">
    <div class="previewSection">
      <h3 class="pdfTitle">{{course.externalCourseName}}</h3>
      <ng-container *ngFor="let chapter of course.chapters; let i = index">
        <div *ngIf="(course.chapters.length - 1 !== i) && chapter.chapterType !== 'fileUpload' && checkActivityMedia(chapter)" id="chapterSplit">
        <h5 class="text-center pb-1">Chapter {{i+1}}</h5>
          <ng-container *ngFor="let activity of chapter.activities">

            <!-- Text -->
            <ng-container *ngIf="activity.activityType === 'text'">
              <ng-container *ngTemplateOutlet="textPreview; context: { config : activity }">
              </ng-container>
            </ng-container>

            <!-- Example -->
            <ng-container *ngIf="activity.activityType === 'example'">
              <ng-container *ngTemplateOutlet="examplePreview; context: { config : activity }">
              </ng-container>
            </ng-container>

            <!-- Quiz -->
            <ng-container *ngIf="activity.activityType === 'quiz'">{{setTotalQuestions()}}
              <div [ngClass]="{'activityQuestion': activity.questions[0]?.content}">
                <ng-container *ngTemplateOutlet="quizPreview; context: { config: activity}">
                </ng-container>
              </div>
            </ng-container>

            <!-- Questionnaire -->
            <!-- <ng-container *ngIf="!course.quizPosition && chapter.questions.length > 0">
              <div class="quizHintCls">
                <h3 class="quizTimeHeading">Quiz time!</h3>
              </div>{{setTotalQuestions()}}
              <ng-container>
                <ng-container *ngTemplateOutlet="quizPreview; context: { config : chapter }">
                </ng-container>
              </ng-container>
            </ng-container> -->

          </ng-container>
        </div>
      </ng-container>
    </div>
  </div>

  <!-- Quiz print section -->
  <div id="quiz-print-section">
    <ng-container>
        <h3 class="pdfTitle">Quiz time!</h3>
      <ng-container>
        <ng-container *ngFor="let chapter of course.chapters; let i = index">
          <div *ngIf="chapter.questions && chapter.questions.length > 0" id="chapterSplit">
            <h5 class="text-center pb-3">
              Chapter {{i+1}}</h5>
            <ng-container *ngTemplateOutlet="quizPreview; context: { config : chapter, print: true }">
            </ng-container>
          </div>
        </ng-container>
      </ng-container>
    </ng-container>
  </div>

  <div id="checklist-print-section">
    <h3 class="pdfTitle">{{course.externalCourseName}}</h3>
    <ng-container *ngFor="let chapter of course.chapters; let i = index">
      <div *ngIf="(course.chapters.length - 1 !== i) && chapter.chapterType !== 'fileUpload'" id="chapterSplit">
        <h5 class="text-center pb-1">{{chapter.content}}</h5>
        <ng-container *ngFor="let activity of chapter.activities">
          <div class="checklistSelect courseContentCls">
            <mat-checkbox *ngIf="activity && activity.content" [name]="'clActivity' + activity.activityId">
              <span>{{activity.content}}</span>
            </mat-checkbox>
          </div>
        </ng-container>
      </div>
    </ng-container>
  </div>
</div>

<a class="d-none" id="mediaDownload"></a>
