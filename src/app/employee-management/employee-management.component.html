<!-- Header 1-->
<section class="courseListSection" (window:resize)=onResize()>
  <!-- <mat-checkbox disabled [checked]="view">View</mat-checkbox>
  <mat-checkbox (change)="create = !create">Create</mat-checkbox>
  <mat-checkbox (change)="update = !update">Update</mat-checkbox> -->
  <div class="d-flex justify-content-between">
    <nav class="navbar navbar-light justify-content-between navbar-container employeeSection">
      <div class="flex-row col-12 p-0">
        <div class="d-flex">
          <form class="form-inline pl-0 mt-2 pb-1 formwidth1">
            <div class="form-group">
              <!-- drop down portion -->
              <div class="searchby-dd pl-1 mr-2">
                <ng-select [items]="searchEmployee" name="searchBy" bindLabel="name" bindValue="key" [clearable]=false
                  [searchable]="false" (change)="clearSearchText()" [(ngModel)]="searchBy" class="mt-1"></ng-select>
              </div>
              <!-- input portion -->
              <div class="searchInputemp">
                <input type="text" id="SearchInputText" class="search-input input-Search employeeInput"
                  [(ngModel)]="searchTextValue" name="search" (change)="searchFilterOnChange()" />
              </div>
            </div>
          </form>
          <!-- date picker portion -->
          <form class="form-inline mt-2 ml-1">
            <div class="form-group ut-search-name">
              <div class="input-group">
                <!-- drop down portion -->
                <div class="searchby-dd pl-1 mr-2">
                  <ng-select [items]="searchByDatelist" name="searchBy" bindLabel="name" bindValue="key"
                    [clearable]=false [searchable]="false" [(ngModel)]="dateBy"></ng-select>
                </div>
                <!-- date picker portion -->
                <div class="input-group-append" name="daterangeInput" daterangepicker [options]="filterDateOption"
                  (selected)="dateRangeChange($event)">
                  <span class="input-group-text">
                    <i class="fa fa-calendar"></i>
                  </span>
                </div>
              </div>
            </div>
          </form>
          <!-- Country region store -->
          <form class="form-inline mt-2 ml-1">
            <mat-form-field appearance="fill" [ngClass]="{appliedFilter : selectedCountryDropDown?.length > 0}"
              class="countryList courseRoleCls marginTop">
              <mat-label *ngIf="selectedCountryDropDown?.length < 1"> Select Countries, Regions, Stores </mat-label>
              <mat-label *ngIf="selectedCountryDropDown?.length > 0" class="levelSelected"> Filter applied </mat-label>
              <mat-select (openedChange)="callGetEmployeeList($event)">
                <mat-checkbox [checked]="storeCount === selectedStoreCount"
                  [indeterminate]="storeCount !== selectedStoreCount && selectedStoreCount > 0" *ngIf="countryList?.length > 0"
                  id="all" class="w-100 allCheckbox pl-3 mt-0" name="allCountries"
                  (change)="selectAll($event, countryList, 'country')">
                  All</mat-checkbox>
                <mat-tree [dataSource]="countryList" [treeControl]="roleTreeControl" class="example-tree countryList">
                  <mat-option>
                    <!-- This is the tree node template for leaf nodes -->
                    <mat-nested-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
                      <li class="mat-tree-node storeList">
                        <!-- use a disabled button to provide padding for tree leaf -->
                        <button mat-icon-button disabled class="d-none"></button>
                        <mat-checkbox data-toggle="tooltip" title="{{node.desc}}"
                          (change)="selectionToggleLeaf($event.checked, node, 'country')"
                          [checked]="node.selectStatus === 'checked'">{{node.desc}}</mat-checkbox>
                      </li>
                    </mat-nested-tree-node>
                    <!-- This is the tree node template for expandable nodes -->
                    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                      <li>
                        <div class="mat-tree-node">
                          <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.desc">
                            <mat-icon class="mat-icon-rtl-mirror mt-2">
                              {{roleTreeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                            </mat-icon>
                          </button>
                          <mat-checkbox data-toggle="tooltip" title="{{node.desc}}"
                            (change)="selectionToggle($event.checked, node, 'country')"
                            [indeterminate]="node.selectStatus === 'mixed'" [checked]="node.selectStatus === 'checked'">
                            {{node.desc}}</mat-checkbox>
                        </div>
                        <ul [class.example-tree-invisible]="!roleTreeControl.isExpanded(node)">
                          <ng-container matTreeNodeOutlet></ng-container>
                        </ul>
                      </li>
                    </mat-nested-tree-node>
                  </mat-option>
                </mat-tree>
              </mat-select>
            </mat-form-field>
          </form>
        </div>

        <!-- <div class="sCountryData ml-1">
          
        </div> -->
      </div>
    </nav>
    <!-- Header 2-->
    <nav class="navbar navbar-light justify-content-between employee-navbar-container mt-3 roleSection">
      <div class="d-flex flex-row col-12 pl-1">
        <div class="ml-auto d-flex flex-row">
          <div class="pl-1">
            <!-- <button [disabled]="view && !create && !update" *ngIf="[utils.portalRole.superAdmin, utils.portalRole.hr].includes(userDetailValue.portalRole)"
              type="button" class="btn btn-primary btn-sm" (click)="empCreate()" data-target="#createUserModal"
              data-toggle="modal">Create user</button> -->
            <button [disabled]="view && !create && !update" *ngIf="userDetailValue.manager === false" type="button"
              class="btn btn-primary btn-sm" (click)="empCreate()" data-target="#createUserModal"
              data-toggle="modal">Create user</button>
          </div>
          <div *ngIf="userDetailValue.manager === false" class="ml-2">
            <!-- <div *ngIf="userDetailValue.portalRole?.toLowerCase() !== 'manager'" class="ml-2"> -->
            <button type="button" class="btn btn-primary btn-sm"
              [disabled]="getSelectedTableRow().length === 0 || getSelectedTableRow().length > 1 || (view && !create && !update)"
              (click)="employeeLink()" data-target="#linkEmployeeModal" data-toggle="modal">Link Employee</button>
          </div>
          <!-- <div *ngIf="currentModule === 'employees'" class="ml-2">
            <button type="button" class="btn btn-primary btn-sm"
              [disabled]="getSelectedTableRow().length === 0 || (view && !create && !update)" data-toggle="modal"
              (click)="getSuggestedCourseData()" data-target="#employeeCourse"> Suggest course </button>
          </div>
          <div class="ml-2">
            <button (click)="inviteType = 'Portal'" type="button" data-target="#inviteConfirmpopup" data-toggle="modal"
              class="btn btn-primary btn-sm"
              [disabled]="getSelectedTableRow().length < 1 || (view && !create && !update)"> Invite 360 Portal </button>
          </div>
          <div class="ml-2">
            <button (click)="inviteType = 'App'" type="button" data-target="#inviteConfirmpopup" data-toggle="modal"
              class="btn btn-primary btn-sm"
              [disabled]="getSelectedTableRow().length < 1 || (view && !create && !update)"> Invite 360 App </button>
          </div> -->

          <div *ngIf="currentModule === 'user-roles'" class="ml-2">
            <button (click)="openAssignUserPopup()" type="button" data-target="#assignRolePopup" data-toggle="modal"
              class="btn btn-primary btn-sm"
              [disabled]="getSelectedTableRow().length < 1 || (view && !create && !update)"> Assign role </button>
          </div>

          <div class="pl-1 mb-2 courseRoleCls">
            <!-- <button *ngIf="[utils.portalRole.superAdmin, utils.portalRole.hr, utils.portalRole.manager].includes(userDetailValue.portalRole)" -->
            <button [disabled]="getSelectedTableRow().length === 0 || (view && !create && !update)"
              [matMenuTriggerFor]="statusButton" type="button"
              class="btn btn-primary btn-sm statusBtn statusActionBtn">Action</button>
          </div>
          <mat-menu #statusButton="matMenu" class="newCoursePopup statusPopup">
            <div class=" p-0 coursePopup">
              <div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="changeStatusAction('Make active')" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#empStatusModal" data-toggle="modal"> Make active </button>
                </div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="changeStatusAction('Temporarily disable')" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#empStatusModal" data-toggle="modal"> Temporarily disable </button>
                </div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="changeStatusAction('Delete')" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#empStatusModal" data-toggle="modal"> Delete </button>
                </div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="getSuggestedCourseData()" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#employeeCourse" data-toggle="modal"> Suggest course </button>
                </div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="inviteType = 'Portal'" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#inviteConfirmpopup" data-toggle="modal"> Invite 360 Portal </button>
                </div>
                <div class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="inviteType = 'App'" class=" d-flex justify-content-start mat-menu-item-pr"
                    mat-menu-item data-target="#inviteConfirmpopup" data-toggle="modal"> Invite 360 App </button>
                </div>
                <!-- <div *ngIf="currentModule === 'user-roles'" class="d-flex justify-content-start align-items-center courseMenu" mat-menu-item>
                  <button (click)="openAssignUserPopup()" class=" d-flex justify-content-start mat-menu-item-pr"
                  mat-menu-item  data-target="#assignRolePopup" data-toggle="modal"> Assign role </button>
                </div> -->
              </div>
            </div>
          </mat-menu>

          <!-- <div class="ml-2">
            <button (click)="openAssignUserPopup()" type="button" data-target="#assignRolePopup" data-toggle="modal" class="btn btn-primary btn-sm"
            > Assign role </button>
          </div> -->

        </div>
      </div>
    </nav>

  </div>
  <!-- Body -->
  <div class="page-container employee-management-page-container">
    <div (scroll)="containerScrollCheck($event)" id="employee-container"
      class="employee-management-container table-responsive"
      [ngClass]="{'hiddenXflow' : showShimmer && paginationIndex == 0}">
      <table mat-table #table [dataSource]="employeeList"
        class="mat-elevation-z8 courseListTbl empListTbl employeeTable overflow-auto table"
        id="employee-container-table">
        <ng-container *ngFor="let column of employeeColumns; let colIndex = index">
          <!-- Checkbox Column -->
          <ng-container *ngIf="column.property === 'select'" [matColumnDef]="column.name">
            <th mat-header-cell *matHeaderCellDef>
              <mat-checkbox (change)="$event ? masterToggle() : null"
                [checked]="selection.hasValue() && isAllSelected()"
                [indeterminate]="selection.hasValue() && !isAllSelected()" [aria-label]="checkboxLabel()">
              </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let row">
              <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
                [checked]="selection.isSelected(row)" [aria-label]="checkboxLabel(row)"></mat-checkbox>
            </td>
          </ng-container>
          <ng-container *ngIf="column.property !== 'select'" [matColumnDef]="column.name">
            <th mat-header-cell *matHeaderCellDef>
              <div class="d-flex flex-row justify-content-between">
                <span [ngbPopover]="menu" placement="bottom" [autoClose]="'outside'" #statusPopover="ngbPopover"
                  (hidden)="onTableFilterPopupClose(column.property === 'role')"
                  [ngClass]="{'filtered-column': (sortBy?.toLowerCase() !== 'reset' && sortByField === column.property) || ((currentFilters[column.property] !== 'All' && (currentFilters[column.property]?.length > 0 || currentFilters[column.property] === true || currentFilters[column.property] === false)) && column.filter)}">
                  {{column.name}}
                  <ng-container [ngTemplateOutlet]="filter_icon"></ng-container>
                </span>
                <!-- showing 3 dots for filter column -->
                <ng-template #filter_icon>
                  <span *ngIf="column.filter" class="fw-600 cursor-pointer ut-filter-status-pointer">
                    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="10px" height="10px"
                      viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">

                      <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000"
                        stroke="none">
                        <path d="M181 5106 c-49 -18 -106 -70 -130 -119 -26 -54 -28 -153 -4 -204 9
-20 447 -503 974 -1075 651 -706 965 -1054 981 -1086 l23 -47 5 -1230 c5
-1212 5 -1231 25 -1265 23 -39 93 -80 138 -80 65 0 94 28 430 414 415 476 398
455 433 518 l29 53 5 795 5 795 27 51 c18 34 338 389 970 1074 519 563 954
1039 968 1059 36 52 41 162 10 226 -26 54 -86 108 -139 123 -57 18 -4702 16
-4750 -2z" />
                      </g>
                    </svg>
                  </span>
                  <span *ngIf="column.sort" class="fw-600 cursor-pointer ut-filter-status-pointer"> &#8645; </span>
                </ng-template>
                <ng-template #menu>
                  <!-- select filter section -->
                  <div *ngIf="column.filter" class="filter-popover">
                    <ng-container
                      *ngIf="column.property === 'appStatus' || column.property === 'active' || column.property === 'employeeStatus' || column.property === 'sfEmployee'">
                      <div *ngFor="let item of availableFilter[column.property]" class="cursor-pointer p-2"
                        [ngClass]="currentFilters[column.property] === item.key ? 'active-status' : 'active-filter-Options'"
                        (click)="updateFilter(item, column)" (keyup)="updateFilter(item, column)">
                        <span>{{item.name }}</span>
                      </div>
                    </ng-container>
                    <ng-container
                      *ngIf="column.property !== 'appStatus' && column.property !== 'active' && column.property !== 'employeeStatus' && column.property !== 'sfEmployee'">
                      <div class="cursor-pointer p-2 d-flex flex-column">
                        <mat-checkbox *ngFor="let item of availableFilter[column.property]" [(ngModel)]="item.checked"
                          (change)="updateFilter(item, column, true)" [name]="column.property + '-' +item" required>
                          {{item.name }}
                        </mat-checkbox>
                      </div>
                    </ng-container>
                    <div *ngIf="availableFilter[column.property]?.length === 0">{{'No filter found'}}. </div>
                  </div>
                  <!-- select sort section for column -->
                  <div *ngIf="column.sort" class="filter-popover">
                    <div *ngFor="let item of sortOption" class="cursor-pointer p-2"
                      [ngClass]="sortByField === column.property && sortBy === item ?'active-status' : 'active-filter-Options'"
                      (click)="updateSort(item, column.property)" (keyup)="updateSort(item, column.property)">
                      <span>{{(item) | titlecase}}</span>
                    </div>
                    <div *ngIf="(sortOption).length === 0">{{'No sorting found'}}.</div>
                  </div>
                </ng-template>
              </div>
            </th>
            <span *ngIf="currentModule === 'employees'">
              <td mat-cell [ngClass]="{InactiveRow: !element.active}" *matCellDef="let element">
                <span *ngIf="column.property === 'edit' && element.active">
                  <a (click)="updateEmployee(element)" data-target="#createUserModal" data-toggle="modal">
                    <mat-icon class="m-0 tableIcons" alt="edit" title="edit">edit</mat-icon>
                  </a>
                </span>
                <!-- <span (click)="getManagerConfirmation(element)"
                  *ngIf="column.property === 'icon' && element.managerConfirmation">
                  <span><img src="/assets/images/indication.png" width="16px" height="16px"
                      data-target="#courseConfirmation" data-toggle="modal"></span>
                </span> -->
                <div class="suggestedEmpName">
                  <span *ngIf="column.property === 'username'" class="d-flex align-items-center">
                    <span (click)="getManagerConfirmation(element)" *ngIf="element.managerConfirmation"><img
                        src="/assets/images/indication.png" width="16px" height="16px" class="mr-2 mb-1"
                        data-target="#courseConfirmation" data-toggle="modal"></span>
                    <span data-toggle="tooltip" title="{{element.username}}">{{element.username || '-'}}</span>
                  </span>
                </div>
                <span (click)="openSuggestCourse(element)" data-target="#courseDetailsModal" data-toggle="modal"
                  *ngIf="column.property === 'employeeId'" [ngClass]="element.overDue ? 'redLink' : 'empIdLink'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'dateOfJoining'">
                  {{element[column.property] | dateUtcToLocal : utils.FORMAT.DATEM}}
                </span>
                <span *ngIf="column.property === 'roleGroup'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'role'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'country'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'region'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'store'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'levelName'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'currentCourse'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'completedCourseCount'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'completedPolicyCount'">
                  {{element[column.property] || '-'}}
                </span>
                <!-- <span *ngIf="column.property === 'upcomingcourse'">
                  {{element[column.property] || '-'}}
                </span> -->
                <span *ngIf="column.property === 'employeeStatus'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'sfEmployee'">
                  {{element[column.property] === true ? 'SF' : '360' || '-'}}
                </span>
                <span *ngIf="column.property === 'active'">
                  {{element[column.property] === true ? 'Active' : 'Temporarily disabled' || '-'}}
                </span>
                <span *ngIf="column.property === 'appStatus'">
                  {{element[column.property] === true ? 'Invited' : '-' || '-'}}
                </span>
              </td>
            </span>
            <span *ngIf="currentModule === 'user-roles'">
              <td mat-cell [ngClass]="{InactiveRow: !element.active}" *matCellDef="let element">
                <span *ngIf="column.property === 'edit' && element.active">
                  <a (click)="updateEmployee(element)" data-target="#createUserModal" data-toggle="modal">
                    <mat-icon class="m-0 tableIcons" alt="edit" title="edit">edit</mat-icon>
                  </a>
                </span>
                <span *ngIf="column.property === 'username'" class="d-flex align-items-center">
                  <span data-toggle="tooltip" title="{{element.username}}">{{element.username || '-'}}</span>
                </span>
                <span *ngIf="column.property === 'employeeId'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'dateOfJoining'">
                  {{element[column.property] | dateUtcToLocal : utils.FORMAT.DATEM}}
                </span>
                <span *ngIf="column.property === 'role'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'appAuthRole'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'learnerRole'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'incidentRole'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'auditRole'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'lastLogin'">
                  {{element[column.property] | dateUtcToLocal : utils.FORMAT.DATEM || '-'}}
                </span>
                <span *ngIf="column.property === 'country'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'region'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'store'">
                  {{element[column.property] || '-'}}
                </span>
                <span *ngIf="column.property === 'active'">
                  {{element[column.property] === true ? 'Active' : 'Temporarily disabled' || '-'}}
                </span>
                <span *ngIf="column.property === 'appStatus'">
                  {{element[column.property] === true ? 'Invited' : '-' || '-'}}
                </span>
              </td>
            </span>
          </ng-container>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="employeeColumnsToDisplay"></tr>
        <tr mat-row [ngClass]="{'active-row': rowSelected(row)}"
          *matRowDef="let row; columns: employeeColumnsToDisplay;">{{row.isChecked}}</tr>
      </table>
      <div *ngIf="showShimmer" class="adjustshimmertable" [style.width.px]="shimmerWidth"
        [ngClass]="{'hideheader' : paginationIndex == 0 , 'showheader' : paginationIndex > 0}">
        <app-shimmertable></app-shimmertable>
      </div>
      <div *ngIf="employeeList.length === 0  && recordFound == true" class="text-center app-no-record-found"> No record
        found </div>
    </div>
  </div>
  <!-- Footer -->
  <!-- <div class="">
    <nav class="navbar navbar-expand-md page-footer">
      <form class="form-inline pr-2">

      </form>
    </nav>
  </div> -->
</section>
<!-- inviteConfirmpopup Link  MODAL -->
<div class="modal fade linkedEmployee empLink inviteModal" id="inviteConfirmpopup" tabindex="-1" role="dialog"
  aria-labelledby="linkEmployeeModalTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title" id="exampleModalLongTitle">Invite 360 {{inviteType}}</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body -flex align-items-center">
        <div> Please confirm to 'Invite 360 {{inviteType}}' for the selected Employee. </div>
      </div>
      <div class="modal-footer p-0 border-0">
        <button type="button" #closeInvite360Modal class="btn userDlgBtn cancelBtn saveDraft"
          (click)="closeInviteMail()" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary newCourseBtn" (click)="invite360Mobile()">Confirm</button>
      </div>
    </div>
  </div>
</div>

<!-- CREATE USER MODAL -->
<div class="modal fade linkedEmployee createUserModal empLink" id="createUserModal" tabindex="-1" role="dialog"
  aria-labelledby="createUserModalTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title" id="exampleModalLongTitle">Employee {{empVal}}</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body pb-3" [ngClass]="{'emp-overlay': userDetailValue.manager === true}">
        <!-- [ngClass]="{'emp-overlay': ![utils.portalRole.superAdmin, utils.portalRole.hr].includes(userDetailValue.portalRole)}"> -->
        <form #createForm="ngForm" validate>
          <div>

            <div class="d-flex justify-content-between">
              <span class="currPromemployee">Basic Info</span>
              <!-- <span class="currPromemployee" *ngIf="!empValueStatus">Promoted Employee: <span *ngIf="!empValueStatus"
                  class="ml-2">{{userDetail.promotedEmployeeId || "-"}}</span></span> -->
            </div>

            <div class="currentEmployee">
              <div class="row mt-0">
                <div class="col-sm-6">
                  <div class="row">
                    <div class="d-block align-items-center">
                      <span class="employeeDetails">First Name</span>
                      <input type="text" class="form-control error-input-box" id="firstname" maxlength="30"
                        [(ngModel)]="userDetail.firstName" name="firstName" #name="ngModel" required>
                      <div *ngIf="!name?.valid && (name?.dirty || name?.touched)" class="error" id="name">
                      </div>
                      <div class="col-sm-9">
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-sm-6">
                  <div class="row">
                    <div class="d-block align-items-center">
                      <span class="employeeDetails">Last Name</span>
                      <input type="text" class="form-control error-input-box lastNameCls" id="lastname" maxlength="30"
                        [(ngModel)]="userDetail.lastName" name="lastName" #name="ngModel">
                      <!-- <div *ngIf="!name?.valid && (name?.dirty || name?.touched)" class="error" id="name">
                      </div> -->
                      <div class="col-sm-9">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-0">
                <!-- <div class="col-sm-6">
                  <div class="row">
                    <div class="d-block align-items-center">
                      <span class="employeeDetails">Phone Number</span>
                      <input type="number" class="form-control error-input-box noarrow phoneNumber" id="mobileNo"
                        maxlength="15" [(ngModel)]="userDetail.mobile" pattern="[0-9_ ]*$" name="phone"
                        #mobileNo="ngModel" required>
                      <div *ngIf="!mobileNo?.valid && (mobileNo?.dirty || mobileNo?.touched)" class="error"
                        id="mobileNo">
                      </div>
                      <div class="col-sm-8">
                      </div>
                    </div>
                  </div>
                </div> -->
                <div class="col-sm-6">
                  <div class="row ">
                    <div class="d-block align-items-center">
                      <span class="employeeDetails">Email ID</span>
                      <input type="text" class="form-control error-input-box emailIdCls" id="emailId" maxlength="60"
                        [(ngModel)]="userDetail.email" pattern="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,6})+$"
                        name="emailId" #emailId="ngModel" required>
                      <div *ngIf="!emailId?.valid && (emailId?.dirty || emailId?.touched)" class="error" id="name">
                      </div>
                      <div class="col-sm-10">
                      </div>
                    </div>
                  </div>
                </div>
                <div [ngClass]="{editDetails: empEditStatus}" class="col-sm-6 empDetailsTrainer">
                  <div class="row ">
                    <div class="d-block align-items-center">
                      <mat-checkbox [checked]="userDetail.isTrainer === true" (change)="onTrainerCheck($event)"></mat-checkbox>
                      <span class="employeeDetails">Trainer</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <hr class="table-div" *ngIf="periodContainer.length > 0" />
          <div class="">
            <div class="d-flex justify-content-between align-items-center">
              <span class="currPromemployee">Other Info</span>

            </div>
            <div class="currentEmployee otherInfoCls">

              <div class="row mt-0">
                <div class="pl-3">
                  <div class="row flex-nowrap">
                    <div class="" [ngClass]="{editDetails: empEditStatus}">
                      <div class="">
                        <div class="d-block align-items-center otherContent">
                          <span class="employeeDetails mr-3">DOJ</span>
                          <div class="date-range" title="Select date range for employee management">
                            <mat-form-field class="dateContent">
                              <input matInput [matDatepicker]="picker" placeholder="Choose a date" name="dateOfJoining"
                                [(ngModel)]="userDetail.dateOfJoining" [disabled]="empEditStatus">
                              <mat-datepicker-toggle matSuffix [for]="picker">
                                <mat-icon matDatepickerToggleIcon>
                                  <img src="/assets/images/calendar.svg" width="11px" height="12.5px">
                                </mat-icon>
                              </mat-datepicker-toggle>
                              <mat-datepicker #picker></mat-datepicker>
                            </mat-form-field>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="p-0" [ngClass]="{editDetails: empEditStatus}">
                      <div class="">
                        <div class="d-block align-items-center">
                          <span class="employeeDetails mr-3">Role</span>
                          <div class="dropdown employeeContent roleContent">
                            <ng-select class="auto-dd error-input modal-auto-dd" [disabled]="empEditStatus"
                              [items]="allRoleList" (change)="setRoleValue()" bindLabel="desc" bindValue="desc"
                              [(ngModel)]="userDetail.role" placeholder="Select Role" name="roleName" required
                              #roleName="ngModel">
                              <ng-template ng-option-tmp let-item="item">
                                <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                                </div>
                              </ng-template>
                            </ng-select>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div *ngIf="!userDetail.isTrainer" class="p-0">
                      <div class="">
                        <div class="d-block align-items-center">
                          <span class="employeeDetails mr-3">Manager</span>
                          <div class="dropdown employeeContent managerContent">
                            <ng-select class="auto-dd error-input managerContent modal-auto-dd" [items]="managerList"
                              bindLabel="name" bindValue="employeeId" [(ngModel)]="userDetail.reportingManager"
                              placeholder="Select Manager" name="manager" #managerName="ngModel">
                              <!-- required -->
                              <ng-template ng-option-tmp let-item="item">
                                <div for="title" class="ng-option-label" [title]="item.name">{{item.name}}
                                </div>
                              </ng-template>
                            </ng-select>
                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="!userDetail.isTrainer">
            <div *ngIf="userDetail.roleId !== 5" class="profitStore">
              <hr class="table-div" />
              <div class="d-flex justify-content-between">
                <span class="currPromemployee">Profit Center</span>
              </div>
              <div class="currentEmployee empInfo">
                <div class="row mt-0">
                  <div class="" [ngClass]="{editDetails: empEditStatus}">
                    <div class="">
                      <div class="d-block align-items-center">
                        <span class="employeeDetails mr-3">Country</span>
                        <div class="dropdown employeeContent countryContent">
                          <ng-select class="auto-dd error-input modal-auto-dd" [disabled]='empEditStatus'
                            (change)="loadRegionList('singleRegion', $event, null)" [items]="countryList" bindLabel="desc"
                            bindValue="desc" [(ngModel)]="userDetail.country" placeholder="Select Country" name="countryName"
                            required #countryName="ngModel">
                            <ng-template ng-option-tmp let-item="item">
                              <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                              </div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="" [ngClass]="{editDetails: empEditStatus}">
                            <div class="">
                              <div class="d-block align-items-center">
                                <span class="employeeDetails mr-3">Region</span>
                                <div class="dropdown employeeContent">
                                  <ng-select class="auto-dd error-input" [disabled]='regionEnable || empEditStatus'
                                    (change)="loadStoreList('singleStore',$event, null)" [items]="regionList" bindLabel="desc"
                                    bindValue="desc" [(ngModel)]="userDetail.region" placeholder="Select Region" name="regionName"
                                    required #regionName="ngModel">
                                    <ng-template ng-option-tmp let-item="item">
                                      <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                                      </div>
                                    </ng-template>
                                  </ng-select>
                                </div>
                              </div>
                            </div>
                          </div> -->
                  <div class="" [ngClass]="{editDetails: empEditStatus}">
                    <div class="">
                      <div class="d-block align-items-center">
                        <span class="employeeDetails mr-3">Store</span>
                        <div class="dropdown employeeContent storeContent">
                          <ng-select class="auto-dd error-input modal-auto-dd" [disabled]="storeEnable || empEditStatus"
                            (change)="getStoresRegion(null); loadManagerList();" [items]="storeList" bindLabel="desc"
                            bindValue="desc" [(ngModel)]="userDetail.store" placeholder="Select Store" name="storeName" required
                            #storeName="ngModel">
                            <ng-template ng-option-tmp let-item="item">
                              <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                              </div>
                            </ng-template>
                          </ng-select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-sm-2 p-0 addProfitEmp d-flex align-items-end">
                    <button type="button" (click)="addPrieod()" class="btn btn-primary newCourseBtn">Click to add a second
                      store
                    </button>
                  </div>
                </div>
          
              </div>
            </div>
          </div>

          <hr class="table-div" />
          <div class="">
            <div class="profitCenterCls secondaryProfit">
              <div class="d-flex justify-content-between" *ngIf="periodContainer.length > 0">
                <span class="currPromemployee">Secondary Profit Center</span>
              </div>
              <div class=" justify-content-between align-items-center ddCls" id="contentInside{{ i }}"
                *ngFor="let container of periodContainer; let i = index">

                <div class="d-flex align-items-center">
                  <div class="currentEmployee ">
                    <div class="row mt-0">
                      <div class="col-sm-4">
                        <div class="row ">
                          <div class="d-block align-items-center">
                            <span class="employeeDetails mr-3">Country</span>
                            <div class="dropdown employeeContent countryContent">

                              <!-- <input type="text" class="form-control error-input-box" id="periodId" maxlength="30"
                      [(ngModel)]="periodId[i]" name="id"> -->

                              <ng-select class="auto-dd error-input modal-auto-dd"
                                (change)="loadRegionList('singleRegion', $event, i)" [disabled]='regionEnable[i]'
                                [items]="countryList" bindLabel="desc" bindValue="desc" placeholder="Select Country"
                                [(ngModel)]="periodCountry[i]" [name]="'countryPeriodName' + i" required>
                                <ng-template ng-option-tmp let-item="item">
                                  <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                                  </div>
                                </ng-template>
                              </ng-select>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="col-sm-4">
                        <div class="row">
                          <div class="d-block align-items-center">
                            <span class="employeeDetails mr-3">Region</span>
                            <div class="dropdown employeeContent">
                              <ng-select class="auto-dd error-input"
                                [disabled]="periodRegionList[i]?.length > 0 ? false : true"
                                (change)="loadStoreList('singleStore', $event, i)" [items]="periodRegionList[i]"
                                bindLabel="desc" bindValue="desc" placeholder="Select Region"
                                [(ngModel)]="periodRegion[i]" [name]="'periodRegionName' + i" required>
                                <ng-template ng-option-tmp let-item="item">
                                  <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                                  </div>
                                </ng-template>
                              </ng-select>
                            </div>
                          </div>
                        </div>
                      </div> -->
                      <div class="col-sm-4">
                        <div class="row">
                          <div class="d-block align-items-center">
                            <span class="employeeDetails mr-3">Store</span>
                            <div class="dropdown employeeContent storeContent">
                              <ng-select class="auto-dd error-input modal-auto-dd" (change)="getStoresRegion(i)"
                                [disabled]="periodStoreList[i]?.length > 0 ? false : true" [items]="periodStoreList[i]"
                                bindLabel="desc" bindValue="desc" [(ngModel)]="periodStore[i]"
                                placeholder="Select Store" [name]="'periodStoreName' + i" required>
                                <ng-template ng-option-tmp let-item="item">
                                  <div for="title" class="ng-option-label" [title]="item.desc">{{item.desc}}
                                  </div>
                                </ng-template>
                              </ng-select>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="row mt-0">
                      <div class="col-sm-4">
                        <div class="row ">
                          <div class="d-block align-items-center">
                            <span class="employeeDetails mr-3">Start Date</span>
                            <div class="date-range profitDate" title="Select date range for employee management">
                              <mat-form-field class="dateContent">
                                <input matInput [matDatepicker]="pickerFromName" placeholder="Choose a date"
                                  [name]="'periodDateFrom' + i" [(ngModel)]="periodFromDate[i]">
                                <mat-datepicker-toggle matSuffix [for]="pickerFromName">
                                  <mat-icon matDatepickerToggleIcon>
                                    <img src="/assets/images/calendar.svg" width="11px" height="12.5px">
                                  </mat-icon>
                                </mat-datepicker-toggle>
                                <mat-datepicker #pickerFromName></mat-datepicker>
                              </mat-form-field>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- <div class="col-sm-1 d-block align-items-center dateFromToCls">

                  </div> -->
                      <div class="col-sm-4">
                        <div class="row">
                          <div class="d-block align-items-center">
                            <span class="employeeDetails mr-3">End Date</span>
                            <div class="date-range profitDate profitToDate"
                              title="Select date range for employee management">
                              <mat-form-field class="dateContent">
                                <input [min]="periodFromDate[i]" matInput [matDatepicker]="pickerToName"
                                  placeholder="Choose a date" [name]="'periodToDate' + i" [(ngModel)]="periodToDate[i]"
                                  [required]="periodFromDate[i]">
                                <mat-datepicker-toggle matSuffix [for]="pickerToName">
                                  <mat-icon matDatepickerToggleIcon>
                                    <img src="/assets/images/calendar.svg" width="11px" height="12.5px">
                                  </mat-icon>
                                </mat-datepicker-toggle>
                                <mat-datepicker #pickerToName></mat-datepicker>
                              </mat-form-field>
                            </div>

                          </div>
                        </div>
                      </div>
                    </div>

                  </div>
                  <div>
                    <img src="assets/images/delete-user.svg" height="15px" width="15px"
                      (click)="deletePrieod(i, $event)" class="ml-3">
                  </div>
                </div>

              </div>
            </div>

          </div>
        </form>
      </div>
      <div class="modal-footer justify-content-start p-0 border-0">
        <button type="button" #closeUserCreateModal (click)="closeEmpCreatePopup()"
          class="btn userDlgBtn cancelBtn saveDraft" data-dismiss="modal">Cancel</button>
        <ng-container *ngIf="userDetailValue.manager === false">
          <!-- <ng-container *ngIf="[utils.portalRole.superAdmin, utils.portalRole.hr].includes(userDetailValue.portalRole)"> -->
          <button type="button" class="btn btn-primary newCourseBtn newCourseBtn1" *ngIf="this.isButtonCreate"
            [disabled]="!createForm.valid" (click)="ngxService.start(); saveUserDetail('create')">Save</button>
          <button type="button" class="btn btn-primary newCourseBtn newCourseBtn1" *ngIf="this.isButtonCreate"
            [disabled]="!createForm.valid" (click)="ngxService.start(); saveUserDetail('createInvaite')">Save &
            Invite</button>
          <button type="button" class="btn btn-primary newCourseBtn newCourseBtn1" *ngIf="this.isButtonUpdate"
            [disabled]="!createForm.valid" (click)="ngxService.start(); updateUserDetail()">Update</button>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<!-- Emp Status Modal -->
<div class="modal empStatusModal" id="empStatusModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog d-flex align-items-center modal-dialog-centered modal-md" role="document">
    <div class="saveConfirmationModel actionModal modal-dialog modal-confirm">
      <div class="modal-content">
        <div class="modal-header">
          <span>{{statusAction}} Action</span>
        </div>
        <div class="modal-body ">
          <div class="setupOption">
            <span class="fontBold selectedItems">Selected Items</span>
            <div class="publishCls m-3">
              <div class="row">
                <div class="col-sm-4">
                  <span class="fontBold">Active </span>
                </div>
                <div class="col-sm-1">
                  <span>-</span>
                </div>
                <div class="col-sm-4">
                  <span>{{activeCount}}</span>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-4">
                  <span class="fontBold">Temporarily disable</span>
                </div>
                <div class="col-sm-1">
                  <span>-</span>
                </div>
                <div class="col-sm-4">
                  <span>{{inactiveCount}}</span>
                </div>
              </div>
            </div>
            <div class="d-flex">
              {{ statusAction === 'Make active' ? inactiveCount + ' / ' + selectedCount + ' ' + 'items will be make active' : statusAction === 'Temporarily disable' ? activeCount + ' / ' + selectedCount + ' ' + 'items will be temporarily disabled' : activeCount + ' / ' + selectedCount + ' ' + 'items will be deleted' }}
              <!-- <span>{{statusAction === 'Make active' ? inactiveCount : activeCount}}</span>/ <span>{{selectedCount}} </span>
                <span>{{statusAction === 'Make active' ? 'items will be make active' : 'items will be temporarily disabled'}}</span> -->
            </div>
          </div>
        </div>
        <div class="modal-footer border-0 p-0  justify-content-start">
          <div class="m-0 w-100 d-flex justify-content-end">
            <button #closeStatusModal (click)="closeStatusPopup()" data-dismiss="modal"
              class="btn userDlgBtn cancelBtn float-right mr-3 saveDraft">Cancel</button>
            <button class="btn btn-primary newCourseBtn float-left mr-3" (click)="saveEmployeeStatus()">Confirm</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Employee Link  MODAL -->
<div class="modal fade linkedEmployee empLink" id="linkEmployeeModal" tabindex="-1" role="dialog"
  aria-labelledby="linkEmployeeModalTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content linkedEmployeeHeight">
      <div class="modal-header">
        <span class="modal-title linkEmpTitle" id="exampleModalLongTitle">Link Employee</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body pb-3">

        <div class="row mt-2 headerDDCls">
          <div class="col-sm-6">
            <div class="row mt-0 align-items-center">
              <div class="col-sm-4 mb-3">
                <span class="employeeDetails">Employee ID</span>
              </div>
              <div class="col-sm-8 pl-0">
                <div class="dropdown employeeContent">
                  <ng-select class="large-dd error-input " [items]="employeedIdandName" [multiple]="false"
                    [hideSelected]="true" bindLabel="employeeId" bindValue="employeeId" [closeOnSelect]="true"
                    [clearable]="true" placeholder="Select Employee Id" name="employeeId"
                    [(ngModel)]="proEmployeeDetailLink.promotedEmployeeId"
                    (change)="getPromotedEmployeeId(null); resetPromotedEmployee($event)" #promotedEmpId="ngModel">
                  </ng-select>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="row align-items-center">
              <div class="col-sm-4 mb-3">
                <span class="employeeDetails">Emp. Name</span>
              </div>
              <div class="col-sm-8 pl-0">
                <div class="dropdown employeeContent">
                  <ng-select class="large-dd error-input " [items]="employeedIdandName" [multiple]="false"
                    [hideSelected]="true" bindLabel="username" bindValue="username" [closeOnSelect]="true"
                    [clearable]="true" placeholder="Select Employee Name" name="username"
                    [(ngModel)]="proEmployeeDetailLink.promotedEmployeeName"
                    (change)="getPromotedEmployeeName(); resetPromotedEmployee($event)" #promotedEmpName="ngModel">
                  </ng-select>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="linkTblFormCls">
          <table class="linkEmployeeTable">
            <tr class="linkEmployeeTableHeaderBorder">
              <ng-container *ngFor="let column of linkEmployeeColumns">
                <th>
                  {{column.name}}
                </th>
              </ng-container>
            </tr>
            <ng-container *ngFor="let column of linkEmployeeData">
              <tr class="linkEmployeeTableRow">
                <td style="font-weight: 500;">
                  {{column.label}}
                </td>
                <td class="linkEmpClm">
                  {{employeeDetailLink[column.currentProperty] || '-'}}
                </td>
                <td class="linkEmpClm">
                  {{proEmployeeDetailLink[column.promotedProperty] || '-'}}
                </td>
              </tr>
            </ng-container>
          </table>
        </div>
      </div>
      <div class="modal-footer p-0 border-0 linkEmpFooter">
        <button type="button" #closeEmpLinkModal class="btn userDlgBtn cancelBtn linkEmpCancelBtn"
          (click)="closeEmplinkPopup()" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-primary linkEmpBtn"
          [disabled]="!proEmployeeDetailLink.promotedEmployeeName || !proEmployeeDetailLink.promotedEmployeeId"
          (click)="saveEmployeeLink()">Link Employee</button>
      </div>
    </div>
  </div>
</div>

<button style="display: none;" #suggestModal data-toggle="modal" data-target="#employeeCourse"></button>
<div class="modal fade linkedEmployee suggestCourseModal" id="employeeCourse" tabindex="-1" role="dialog"
  aria-labelledby="suggestCourseModalLongTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header employee-header">
        <span class="modal-title" id="suggestCourseModalLongTitle">
          {{getSelectedTableRow().length === 1 ? headerSuggestCourseObj?.employeeId +' -> Suggested Course' : 'Suggested Course'}}
        </span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <form *ngIf="selectedRowDetail.length === 1" class="form-inline">
            <div class="form-group col-sm-6 pl-0">
              <label for="employee" class="fontBold">Emp Name</label>
              <span for="empName" class="px-2 suggestedEmpName">{{headerSuggestCourseObj?.firstName}}
                {{headerSuggestCourseObj?.lastName || ''}}</span>
            </div>
            <div class="form-group col-sm-6 p-0">
              <label for="role" class="fontBold">Role</label>
              <span for="role" class="pl-2 suggestRoleName">{{headerSuggestCourseObj?.role}}</span>
            </div>
          </form>
          <form class="form-inline currentEmployee px-3 pb-0  mb-2 suggestEmployee">

            <div class="cursor-pointer p-2 d-flex flex-column suggestCourseDD">
              <ng-select [items]="roleCourseDetails" (change)="checkSuggestedCourse()" [multiple]="true"
                bindLabel="courseName" bindValue="courseId" name="externalName" [selectableGroup]="false"
                [closeOnSelect]="false" [(ngModel)]="selectedRoleGroup" placeholder="Suggest Courses"
                class="suggestCourseSelection">
                <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                  <input class="mr-2" id="item-{{index}}" name="item-{{index}}" type="checkbox"
                    [(ngModel)]="item$.selected" (change)="setSuggestedCourse($event, item$)" /> {{item.courseName}}
                </ng-template>
                <ng-template ng-multi-label-tmp>
                  <div class="ng-value" *ngIf="selectedRoleGroup.length > 0">
                    <span class="ng-value-label">
                      {{selectedRoleGroup.length}} Course selected...</span>
                  </div>
                </ng-template>
              </ng-select>
            </div>

            <div class="form-group col-sm-4 p-0">
              <button [disabled]="suggestButtonEnabled" type="button" class="btn btn-primary newCourseBtn"
                (click)="postSuggestedCourseData()">
                Suggest course </button>
            </div>
          </form>

          <hr class="table-line">
          <!-- show suggested courses for single select -->
          <div *ngIf="selectedRowDetail.length === 1" class="form-group suggestedPopupTable">

            <table *ngIf="showShimmer2 == false" mat-table [dataSource]="empSuggestedCourseDetails"
              class="mat-elevation-z8 suggestCourseTbl">

              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td *matCellDef="let element; let i = index"> {{i + 1}}</td>
              </ng-container>

              <ng-container matColumnDef="SuggestedCourse">
                <th mat-header-cell *matHeaderCellDef> Suggested Courses</th>
                <td class="suggPopupCoursename" mat-cell *matCellDef="let element" data-toggle="tooltip"
                  [title]="element.courseName"> {{element.courseName}} </td>
              </ng-container>

              <ng-container matColumnDef="suggestedDate">
                <th mat-header-cell *matHeaderCellDef> Suggested Date</th>
                <td mat-cell *matCellDef="let element"> {{element.created | dateUtcToLocal: utils.FORMAT.DATEM}} </td>
              </ng-container>

              <ng-container matColumnDef="Action">
                <th mat-header-cell *matHeaderCellDef> </th>
                <td mat-cel class="removeText" (click)="deleteSuggestedCourse(element)" *matCellDef="let element">
                  <div *ngIf="!element.status">Remove</div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="suggestColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: suggestColumns;"></tr>
            </table>
            <div *ngIf="empSuggestedCourseDetails.length === 0 && showShimmer2 == false"
              class="text-center suggestedNorecord"> No record found
            </div>
            <div *ngIf="showShimmer2 == true" class="widthtable">
              <div class="dummyth">
                <div class="th th1">#</div>
                <div class="th th2">Suggested Courses</div>
                <div class="th th3">Suggested Date</div>
                <div class="th th4"></div>
              </div>
              <app-shimmertable [type]="2"></app-shimmertable>
            </div>
          </div>
          <!-- Show user list for multi select -->
          <div *ngIf="selectedRowDetail.length > 1" class="form-group suggestedPopupUsersTable">

            <table mat-table [dataSource]="selectedRowDetail" class="mat-elevation-z8 suggestCourseTbl">

              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td *matCellDef="let element; let i = index"> {{i + 1}}</td>
              </ng-container>

              <ng-container matColumnDef="EmployeeId">
                <th mat-header-cell *matHeaderCellDef> Employee id</th>
                <td mat-cell *matCellDef="let element"> {{element.employeeId}} </td>
              </ng-container>

              <ng-container matColumnDef="EmployeeName">
                <th mat-header-cell *matHeaderCellDef> Employee name</th>
                <td class="suggPopupCoursename" mat-cell *matCellDef="let element" data-toggle="tooltip"
                  [title]="element.firstName"> {{element.firstName}} </td>
              </ng-container>

              <ng-container matColumnDef="Role">
                <th mat-header-cell *matHeaderCellDef> Role</th>
                <td class="suggPopupCoursename" mat-cell *matCellDef="let element" data-toggle="tooltip"
                  [title]="element.role"> {{element.role}} </td>
              </ng-container>

              <ng-container matColumnDef="Action">
                <th mat-header-cell *matHeaderCellDef> </th>
                <td mat-cel class="removeText" (click)="deleteSelectedUser(element)" *matCellDef="let element">
                  Remove </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="['id', 'EmployeeId', 'EmployeeName', 'Role', 'Action']"></tr>
              <tr mat-row *matRowDef="let row; columns: ['id', 'EmployeeId', 'EmployeeName', 'Role', 'Action'];"></tr>
            </table>
          </div>
        </form>
      </div>
      <div class="modal-footer employee-footer p-0 border-0">
        <button type="button" class="btn userDlgBtn cancelBtn saveDraft" data-dismiss="modal"
          (click)="cleanoldSuggest()">Done</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade linkedEmployee" id="courseConfirmation" tabindex="-1" role="dialog"
  aria-labelledby="suggestCourseModalLongTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header employee-header">
        <span class="modal-title" id="suggestCourseModalLongTitle">{{formSuggestCourseObj?.employeeId}} -> Course
          Confirmation</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #formSuggestCourse="ngForm" novalidate>
          <form class="form-inline">
            <div class="form-group col-sm-8 p-0">
              <label for="employee" class="fontBold">Emp Name</label>
              <span for="empName" class="px-2 suggestedEmpName">{{formSuggestCourseObj?.firstName}}
                {{formSuggestCourseObj?.lastName ? ' '+
                formSuggestCourseObj?.lastName : ''}}</span>
            </div>
            <div class="form-group col-sm-4 p-0">
              <label for="role" class="fontBold">Role</label>
              <span for="role" class="pl-2 suggestedEmpName suggestRoleName">{{formSuggestCourseObj?.role}}</span>
            </div>
          </form>
          <hr class="table-line mb-0">
          <div class="form-group">
            <label for="formGroupExampleInput" class="completedCourse mt-3 mb-0  mx-0 fontBold">Required Manager
              Confirmation
            </label>
          </div>
          <div class="form-group confirmTblCls">
            <div class="absmodelshimmer absmodelshimmer1"
              [ngClass]="{'d-none' : showShimmer1 == false, 'd-block' : showShimmer1 == true}">
              <app-shimmertable [type]="2"></app-shimmertable>
            </div>
            <table mat-table [dataSource]="confirmationCourseList" class="mat-elevation-z8 suggestCourseTbl w-100">

              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td *matCellDef="let element; let i = index"> {{i + 1}}</td>
              </ng-container>

              <ng-container matColumnDef="courseName">
                <th mat-header-cell *matHeaderCellDef> Course Name </th>
                <td mat-cell *matCellDef="let element">
                  <div class="courseConfirmSpan">
                    <span> {{element.courseName}} </span>
                    <span *ngIf="element.chapterId"> {{ ' - ' + element.chapterId}} </span>
                    <span *ngIf="element.chapterName"> {{ ' - ' + element.chapterName}} </span>
                  </div>
                </td>

              </ng-container>

              <ng-container matColumnDef="completionDate">
                <th mat-header-cell *matHeaderCellDef> Completion Date </th>
                <td mat-cell *matCellDef="let element" [ngClass]="{'redText': 'element.overDue'}">
                  {{element.completedDate | dateUtcToLocal : utils.FORMAT.DATEM}} </td>
              </ng-container>

              <ng-container matColumnDef="Action">
                <th mat-header-cell *matHeaderCellDef> </th>
                <td mat-cel class="removeText" *matCellDef="let element">
                  <button class="courseConfirmBtn" (click)="managerConfirm(element)">Confirm</button>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="managerConfirmColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: managerConfirmColumns;"></tr>
            </table>

          </div>
        </form>
      </div>
      <div class="modal-footer employee-footer p-0 border-0">
        <button #closeMagConfirmationModal type="button" class="btn userDlgBtn cancelBtn saveDraft"
          data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade linkedEmployee" id="courseDetailsModal" tabindex="-1" role="dialog"
  aria-labelledby="suggestCourseModalLongTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header employee-header">
        <span class="modal-title" id="suggestCourseModalLongTitle">{{formSuggestCourseObj?.employeeId}} - > Course
          Details</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #formSuggestCourse="ngForm" novalidate>
          <form class="form-inline">
            <div class="form-group col-sm-6 p-0">
              <label for="employee" class="fontBold">Emp Name</label>
              <span for="empName" class="px-2 suggestedEmpName ">{{formSuggestCourseObj?.firstName}}
                {{formSuggestCourseObj?.lastName ? formSuggestCourseObj.lastName : ''}}</span>
            </div>

            <div class="form-group col-sm-6 p-0">
              <label for="role" class="fontBold">Role</label>
              <span for="role" class="pl-2 suggestRoleName">{{formSuggestCourseObj?.role}}</span>
            </div>
          </form>

          <hr class="table-line">
          <div class="form-group tblScrollCss">
            <div class="absmodelshimmer"
              [ngClass]="{'d-none' : showShimmer1 == false, 'd-block' : showShimmer1 == true}">
              <app-shimmertable [type]="2"></app-shimmertable>
            </div>
            <table mat-table [dataSource]="empCourseList" class="mat-elevation-z8 suggestCourseTbl">
              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td *matCellDef="let element; let i = index"> {{i + 1}}</td>
              </ng-container>

              <ng-container matColumnDef="role">
                <th mat-header-cell *matHeaderCellDef> Role </th>
                <td mat-cell *matCellDef="let element" data-toggle="tooltip" title="{{formSuggestCourseObj?.role}}">
                  {{formSuggestCourseObj?.role || '-'}} </td>
              </ng-container>

              <ng-container matColumnDef="levels">
                <th mat-header-cell *matHeaderCellDef> Level Name </th>
                <td mat-cell *matCellDef="let element"> {{element.levelName || '-'}} </td>
              </ng-container>

              <ng-container matColumnDef="externalName">
                <th mat-header-cell *matHeaderCellDef> Course Name </th>
                <td mat-cell *matCellDef="let element" data-toggle="tooltip" title="{{element.externalName}}">
                  {{element.externalName ? element.externalName : element.courseName ? element.courseName : '-'}} </td>
              </ng-container>

              <ng-container matColumnDef="courseType">
                <th mat-header-cell *matHeaderCellDef> Course Type </th>
                <td mat-cell *matCellDef="let element"> {{element.courseType || '-'}} </td>
              </ng-container>

              <ng-container matColumnDef="completionDate">
                <th mat-header-cell *matHeaderCellDef> Completion Date </th>
                <td mat-cell *matCellDef="let element"> {{element.completionDate | dateUtcToLocal : utils.FORMAT.DATEM}}
                </td>
              </ng-container>
              
              <ng-container matColumnDef="manualUpload">
                <th mat-header-cell *matHeaderCellDef> Certificate upload </th>
                <td mat-cell *matCellDef="let element">
                  <div *ngIf="element.manualUpload">
                    <!--  If there is no certificate -->
                    <span style="color: blue;" *ngIf="!element.certName" (click)="import($event)">
                      Upload
                    </span>
                    <!-- If there is certificate -->
                    <span *ngIf="element.certName" (click)="openPdf(element)">
                      Uploaded
                    </span>
                    <!-- Upload area -->
                    <input type="file" class="fileInputCls" (change)="onFileBrowse($event, element)" hidden #uploadFileInput id="file"
                      name="file" [accept]="'application/pdf'" />
                  </div>
                  <div *ngIf="!element.manualUpload"> - </div>
                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <div *ngIf="empCourseList.length === 0" class="text-center app-no-record-found"> No record found </div>

          </div>
        </form>
      </div>
      <div class="modal-footer employee-footer p-0 border-0">
        <button type="button" class="btn userDlgBtn cancelBtn saveDraft" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- Pdf -->
<button data-target="#pdfPopup" data-toggle="modal" style="display: none;" #pdfModal></button>
<div class="modal fade" id="pdfPopup" tabindex="-1" role="dialog"
  aria-labelledby="pdfModalTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">
    <div class="modal-content">
      <div class="modal-header employee-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><mat-icon>close</mat-icon></button>
      </div>
      <div style="height: 50vw;" class="modal-body">
        <pdf-viewer (after-load-complete)="pdfLoader('stop')" [src]="{url: pdfUrl + pdfConfig, withCredentials: true}" [zoom]="1"
        [rotation]="0" [render-text]="true" [original-size]="false" [fit-to-page]="true"
        (page-rendered)="pageRendered($event)" class="pdf slidePreview">
      </pdf-viewer>
      </div>
    </div>
  </div>
</div>

<div class="modal fade linkedEmployee linkedEmployeeAssignrole" id="assignRolePopup" tabindex="-1" role="dialog"
  aria-labelledby="suggestCourseModalLongTitle" data-keyboard="false" data-backdrop='static' aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-md" role="document">
    <div class="modal-content">

      <div class="modal-header employee-header">
        <span class="modal-title" id="suggestCourseModalLongTitle">Assign role</span>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">

        <label>No. of employees selected: {{assignUserList.length}}</label>
        <hr class="table-line">

        <div class="tablePanel">
          <div class="tablePanel_left"><label class="mb-3 mr-3 fontBold roleLbl">Learner's Role</label></div>
          <div class="tablePanel_right">
            <ng-select [items]="learnerRoleList" name="searchBy" bindLabel="roleName" bindValue="id" [clearable]=true
              [(ngModel)]="learnerRoleId" [searchable]="false" (change)="roleChange('LA', $event)"
              class="mt-1"></ng-select>
          </div>
        </div>
        <div class="tablePanel">
          <div class="tablePanel_left"><label class="mb-3 mr-3 fontBold roleLbl">Incident Role</label></div>
          <div class="tablePanel_right"><ng-select [items]="incidentRoleList" name="searchBy" bindLabel="roleName"
              bindValue="id" [clearable]=true [(ngModel)]="incidentRoleId" [searchable]="false"
              (change)="roleChange('IT', $event)" class="mt-1"></ng-select></div>
        </div>
        <div class="tablePanel">
          <div class="tablePanel_left"><label class="mb-3 mr-3 fontBold roleLbl">Audit Role</label></div>
          <div class="tablePanel_right"><ng-select [items]="auditRoleList" name="searchBy" bindLabel="roleName"
              bindValue="id" [clearable]=true [(ngModel)]="auditRoleId" [searchable]="false"
              (change)="roleChange('AT', $event)" class="mt-1"></ng-select></div>
        </div>
        <div class="tablePanel">
          <div class="tablePanel_left"><label class="mb-3 mr-3 fontBold roleLbl">App Auth Role</label></div>
          <div class="tablePanel_right"><ng-select [items]="authRoleList" name="searchBy" bindLabel="roleName"
              bindValue="id" [clearable]=true [(ngModel)]="authRoleId" [searchable]="false"
              (change)="roleChange('AA', $event)" class="mt-1"></ng-select></div>
        </div>

        <!-- <table>
            <tr>
              <td>
                <label class="mb-3 mr-3 fontBold roleLbl">Learner's Role</label>
              </td>
              <td>
                <ng-select [items]="learnerRoleList" name="searchBy" bindLabel="roleName" bindValue="id" [clearable]=false
                  [(ngModel)]="learnerRoleId" (change)="roleChange()" class="mt-1"></ng-select>
              </td>
            </tr>
            <tr>
              <td>
                <label class="mb-3 mr-3 fontBold roleLbl">Incident Role</label>
              </td>
              <td>
                <ng-select [items]="incidentRoleList" name="searchBy" bindLabel="roleName" bindValue="id" [clearable]=false
                  [(ngModel)]="incidentRoleId" (change)="roleChange()" class="mt-1"></ng-select>
              </td>
            </tr>
            <tr>
              <td>
                <label class="mb-3 mr-3 fontBold roleLbl">Audit Role</label>
              </td>
              <td>
                <ng-select [items]="auditRoleList" name="searchBy" bindLabel="roleName" bindValue="id" [clearable]=false
                  [(ngModel)]="auditRoleId" (change)="roleChange()" class="mt-1"></ng-select>
              </td>
            </tr>
            <tr>
              <td>
                <label class="mb-3 mr-3 fontBold roleLbl">App Auth Role</label>
              </td>
              <td>
                <ng-select [items]="authRoleList" name="searchBy" bindLabel="roleName" bindValue="id" [clearable]=false
                  [(ngModel)]="authRoleId" (change)="roleChange()" class="mt-1"></ng-select>
              </td>
            </tr>
          </table> -->
      </div>

      <div class="modal-footer employee-footer p-0 border-0">
        <button type="button" class="btn userDlgBtn cancelBtn saveDraft" data-dismiss="modal"
          (click)="assignRolePopupCancel()">Cancel</button>
        <button type="button" [disabled]="roleIds.length === 0" (click)="assignRole()"
          class="btn btn-primary newCourseBtn mr-2" data-dismiss="modal">Assign</button>
      </div>

    </div>

  </div>
</div>